
<!DOCTYPE>
<html lang="zh-cn" data-scribe-reduced-action-queue="true">

<head>
    <meta content='PWA 简介 - Tate & Snow' name='title' />
    <meta content='PWA 简介 - Tate & Snow' name='og:title' />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
    <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
    <title>PWA 简介 - Tate & Snow</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>PWA 简介 - Tate & Snow</title>
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="PWA 简介 - Tate & Snow">
<meta name="twitter:keywords" content="PWA 简介 - Tate & Snow" property='og:description' />
<meta property="og:type" content="article">
<meta property="og:title" content="PWA 简介 - Tate & Snow">
<meta name="og:keywords" content="PWA 简介 - Tate & Snow|PWA 简介什么是 PWAPWA(Progressive Web App) 即渐进式网络应用，PWA 可以将 Web 和 App 各自的优势融合在一起，是提升 Web App 的体验的一种新方法，能给用户原生应用的体验。其核心技术包括..."
  property='og:description' />
<link rel="icon" type="image/png" href="http://localhost:4000/style/favicons/favicon.ico" />
<link href="http://localhost:4000/style/favicons/favicon.ico" rel="shortcut icon" type="image/png">
<link rel="canonical" href="http://localhost:4000/">
<link rel="alternate" type="application/rss+xml" title="Liberxue" href="http://localhost:4000/feed.xml">
<meta charset="UTF-8">
<link rel="manifest" href="/manifest.json">
<link rel="shortcut icon" href="http://localhost:4000/style/favicons/favicon.ico" type="image/x-icon">
<meta name="keywords" content="PWA 简介什么是 PWAPWA(Progressive Web App) 即渐进式网络应用，PWA 可以将 Web 和 App 各自的优势融合在一起，是提升 Web App 的体验的一种新方法，能给用户原生应用的体验。其核心技术包括..." property='og:description'
/>
<meta name="description" content="Tate & Snow's Github blog" />
<link href="https://cdn.bootcss.com/highlight.js/9.10.0/styles/xcode.min.css" rel="stylesheet">
<link href="http://localhost:4000/style/theme.css" rel="stylesheet"> 
<meta content='http://localhost:4000/2019/04/07/progressive-web-app.html' property='og:url' />
<meta content="http://localhost:4000/2019/04/07/progressive-web-app.html|PWA 简介什么是 PWAPWA(Progressive Web App) 即渐进式网络应用，PWA 可以将 Web 和 App 各自的优势融合在一起，是提升 Web App 的体验的一种新方法，能给用户原生应用的体验。其核心技术包括..." property='og:description'
/>
<meta content="article" property="og:type" />  
<!-- <script>
  (function (i, s, o, g, r, a, m) {
    i['GoogleAnalyticsObject'] = r;
    i[r] = i[r] || function () {
      (i[r].q = i[r].q || []).push(arguments)
    }, i[r].l = 1 * new Date();
    a = s.createElement(o),
      m = s.getElementsByTagName(o)[0];
    a.async = 1;
    a.src = g;
    m.parentNode.insertBefore(a, m)
  })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
  ga('create', 'UA-101222464-1', 'auto');
  ga('send', 'pageview');
</script> -->
 

</head>

<body class="" gtools_scp_screen_capture_injected="true">
    <header id="header" class="header bg-white">
        <div class="navbar-container">
            <a href="/?tate" title="访问 Tate & Snow" class="navbar-logo">
                <img src="https://i.loli.net/2018/03/13/5aa74f5b4c2c7.png" alt="Tate & Snow"> </a>
            <!-- <a href="/?tate" title="访问 Tate & Snow" class="navbar-logo">Tate & Snow</a>   -->
            <div class="navbar-menu">
                
                <a href="/?tate" title="访问 首页" data-hover="首页">首页</a>
                
                <a href="/front?tate" title="访问 前端" data-hover="前端">前端</a>
                
                <a href="/tool?tate" title="访问 框架" data-hover="框架">框架</a>
                
                <a href="/back?tate" title="访问 后端" data-hover="后端">后端</a>
                
                <a href="/tags?tate" title="访问 标签" data-hover="标签">标签</a>
                
                <a href="/README?tate" title="访问 关于" data-hover="关于">关于</a>
                
            </div>
            <!-- <div class="navbar-menu">
                
                <a href="http://localhost:4000/">首页</a>
                
                <a href="http://localhost:4000/front">前端</a>
                
                <a href="http://localhost:4000/tool">框架</a>
                
                <a href="http://localhost:4000/back">后端</a>
                
                <a href="http://localhost:4000/tags">标签</a>
                
                <a href="http://localhost:4000/README">关于</a>
                
            </div> -->
            <div class="navbar-search" onclick="">
                <span class="icon-search"></span>
                <form id="cb-search-btn" role="search">
                    <span class="search-box">
                        <input type="text" class="input" id="cb-search-content" required="true" placeholder="标题 标签..." maxlength="30" autocomplete="off">
                    </span>
                </form>
            </div>
            <div class="navbar-mobile-menu" onclick="">
                <span class="icon-menu cross">
                    <span class="middle"></span>
                </span>
                <ul>
                    
                    <li>
                        <a href="http://localhost:4000/">首页</a>
                    </li>
                    
                    <li>
                        <a href="http://localhost:4000/front">前端</a>
                    </li>
                    
                    <li>
                        <a href="http://localhost:4000/tool">框架</a>
                    </li>
                    
                    <li>
                        <a href="http://localhost:4000/back">后端</a>
                    </li>
                    
                    <li>
                        <a href="http://localhost:4000/tags">标签</a>
                    </li>
                    
                    <li>
                        <a href="http://localhost:4000/README">关于</a>
                    </li>
                    
                </ul>
            </div>
        </div>
    </header>
    <a href="#header" class="back-to-top">⤴Top⤴</a>
    <div class="post-header-thumb bg-white}">
        <div class="post-header-thumb-op"></div>
        <div class="post-header-thumb">
            <div class="post-header-thumb-container">
                <h1 class="post-title" itemprop="name headline">
                    PWA 简介</h1>
                <div class="post-data">
                    <time datetime="2019-04-07 23:40:00" itemprop="datePublished">
                      发布时间：2019-04-07 23:40:00
                      &nbsp;&nbsp;&nbsp;
                      
                        修改时间：2019-04-08 16:34:00
                      
                    </time>
                    <a href="/tags#前端" title="访问 前端" data-hover="博客分类: 前端">博客分类: 前端</a>
                    <!-- <a href="#read"> 阅读次数: comments</a>  -->
                </div>
                <div class="post-tags">
                       
                    <a href="/tags#pwa" title="访问pwa" data-hover="pwa">
                        pwa
                        <span>(1)</span>
                        
                    </a>
                       
                </div>
            </div>
        </div>
    </div>
    <article class="main-content post-page" itemscope itemtype="http://schema.org/Article">
        <div class="post-header">
            <h1 class="post-title" itemprop="name headline">
                PWA 简介</h1>
            <div class="post-data">
                <time datetime="2019-04-07 23:40:00" itemprop="datePublished">2019-04-07 23:40:00</time>
            </div>
        </div>
        <div id="post-content" class="post-content" itemprop="articleBody">
            <p class="post-tags">
                   
                <a href="/tags#pwa" title="访问pwa" data-hover="pwa">
                    pwa
                    <span>(1)</span>
                    </a>
                   
            </p>
            <h1 id="pwa-简介">PWA 简介</h1>

<h2 id="什么是-pwa">什么是 PWA</h2>

<p><strong>PWA(Progressive Web App)</strong> 即渐进式网络应用，PWA 可以将 Web 和 App 各自的优势融合在一起，是提升 Web App 的体验的一种新方法，能给用户原生应用的体验。其核心技术包括:</p>

<ul>
  <li><strong>App Manifest</strong> - Web 应用程序清单，实现可安装</li>
  <li><strong>Service Worker</strong> - 后台运行的独立线程，实现离线使用</li>
  <li><strong>Web Push</strong></li>
</ul>

<h2 id="manifest">Manifest</h2>

<p><a href="https://developer.mozilla.org/zh-CN/docs/Web/Manifest"><strong>Manifest</strong></a> 是一个 JSON 格式的文件，你可以把它理解为一个指定了 Web App 桌面图标、名称、开屏图标、运行模式等一系列资源的一个清单。创建好后直接通过 meta 标签来使用:</p>

<pre><code class="language-HTML">&lt;!-- 在 index.html 中添加以下 meta 标签 --&gt;
&lt;link rel="manifest" href="/manifest.json"&gt;
</code></pre>

<pre><code class="language-JSON">{
  "name": "HackerWeb",
  "short_name": "HackerWeb", # 当没有足够空间展示应用的 name 时，系统就会使用 short_name
  "start_url": "./?utm_source=web_app_manifest", # 指定用户从设备启动应用程序时加载的 URL。 如果以相对 URL 的形式给出，则基本 URL 将是 manifest 的 URL
  "display": "standalone", # 定义开发人员对 Web 应用程序的首选显示模式
  "background_color": "#fff", # 为 web 应用程序预定义的背景颜色
  "orientation": "portrait", # 定义所有 Web 应用程序顶级的默认方向 browsing contexts
  "description": "A simply readable Hacker News app.",
  "icons": [{
    "src": "images/touch/homescreen48.png",
    "sizes": "48x48",
    "type": "image/png"
  }, {
    "src": "images/touch/homescreen72.png",
    "sizes": "72x72",
    "type": "image/png"
  }, {
    "src": "images/touch/homescreen192.png",
    "sizes": "192x192",
    "type": "image/png"
  }],
  "related_applications": [{ # 指定一个“应用程序对象”数组，代表可由底层平台安装或可访问的本机应用程序
    "platform": "web"
  }, {
    "platform": "play",
    "url": "https://play.google.com/store/apps/details?id=cheeaun.hackerweb"
  }]
}
</code></pre>

<p>其中 <code class="highlighter-rouge">display</code> 是用来定义开发人员对 Web 应用程序的首选显示模式:</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">显示模式</th>
      <th style="text-align: left">描述</th>
      <th>后备显示模式</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">fullscreen</td>
      <td style="text-align: left">全屏显示, 所有可用的显示区域都被使用, 并且不显示状态栏</td>
      <td>standalone</td>
    </tr>
    <tr>
      <td style="text-align: left">standalone</td>
      <td style="text-align: left">独立应用模式，这种模式下打开的应用有自己的启动图标，并且不会有浏览器的地址栏。因此看起来更像一个 Native App</td>
      <td>minimal-ui</td>
    </tr>
    <tr>
      <td style="text-align: left">minimal-ui</td>
      <td style="text-align: left">与 standalone 相比，会有浏览器地址栏，样式因浏览器而异</td>
      <td>browser</td>
    </tr>
    <tr>
      <td style="text-align: left">browser</td>
      <td style="text-align: left">该应用程序在传统的浏览器标签或新窗口中打开，具体实现取决于浏览器和平台。 这是默认的设置</td>
      <td>None</td>
    </tr>
  </tbody>
</table>

<h2 id="service-worker">Service Worker</h2>

<h3 id="代理">代理</h3>

<p><strong>Service Worker</strong> 可以简单理解为一个独立于前端页面，在后台运行的进程。它有一个非常重要的特性：你可以在 Service Worker 中监听所有客户端(Web)发出的请求，然后通过它来代理，向后端服务发起请求。通过监听用户请求信息，Service Worker 可以决定是否使用缓存来作为 Web 请求的返回。因此它是实现离线访问的核心，下图展示普通 Web App 与添加了 Service Worker 的 Web App 在网络请求上的差异:</p>

<p><img src="https://user-gold-cdn.xitu.io/2018/4/8/162a560d0bdb6ed1?w=567&amp;h=271&amp;f=png&amp;s=14952" alt="service worker" /></p>

<blockquote>
  <p>Service Worker 实际运行于本机上，相当于一个客户端代理。</p>
</blockquote>

<h3 id="注册">注册</h3>

<p>以下 demo 都<a href="https://github.com/alienzhou/learning-pwa">来自 github 这里</a>:</p>

<pre><code class="language-JS">// index.js
// 注册 service worker，其脚本文件为 sw.js
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('./sw.js').then(function () {
    console.log('Service Worker 注册成功');
  });
}
</code></pre>

<h3 id="生命周期">生命周期</h3>

<p>当我们注册了 Service Worker 后，它会经历生命周期的各个阶段，同时会触发相应的事件。整个生命周期包括了: <code class="highlighter-rouge">installing --&gt; installed --&gt; activating --&gt; activated --&gt; redundant</code>:</p>

<p><img src="https://user-gold-cdn.xitu.io/2018/4/8/162a560d0bdaf33b?w=579&amp;h=867&amp;f=png&amp;s=39680" alt="lifecycle" /></p>

<p>比如可以监听 install 事件:</p>

<pre><code class="language-JS">// 监听 install 事件
self.addEventListener('install', function (e) {
  console.log('Service Worker 状态： install');
});
</code></pre>

<blockquote>
  <p><strong>self</strong> 是 Service Worker 中一个特殊的全局变量，类似于 window 对象。self 引用了当前这个 Service Worker。</p>
</blockquote>

<h3 id="缓存静态资源">缓存静态资源</h3>

<p>要使我们的 Web App 离线可用，就需要将所需资源缓存下来。我们需要一个资源列表，当 Service Worker 被激活时，会将该列表内的资源缓存进 cache:</p>

<pre><code class="language-JS">// sw.js
var cacheName = 'bs-0-2-0';
var cacheFiles = [ // 列出所有的静态资源依赖
  '/',
  './index.html',
  './index.js',
  './style.css',
  './img/book.png',
  './img/loading.svg'
];

// 监听 install 事件，安装完成后，进行文件缓存
self.addEventListener('install', function (e) {
  // caches 是一个全局变量，通过它我们可以操作 Cache 相关接口
  var cacheOpenPromise = caches.open(cacheName).then(function (cache) {
    return cache.addAll(cacheFiles);
  });
  e.waitUntil(cacheOpenPromise);
});
</code></pre>

<p>缓存有了，但是如何告知浏览器使用呢，可以参考以下几个策略:</p>

<p><img src="https://user-gold-cdn.xitu.io/2018/4/8/162a560d2d6b1798?w=567&amp;h=284&amp;f=png&amp;s=19408" alt="cached" /></p>

<p><img src="https://user-gold-cdn.xitu.io/2018/4/8/162a560d30b47136?w=567&amp;h=284&amp;f=png&amp;s=13705" alt="noCache" /></p>

<ol>
  <li>浏览器发起请求，请求各类静态资源</li>
  <li>Service Worker 拦截浏览器请求，并查询当前 cache</li>
  <li>若存在 cache 则直接返回，结束</li>
  <li>若不存在 cache，则通过 fetch 方法向服务端发起请求，并返回请求结果给浏览器</li>
</ol>

<pre><code class="language-JS">// sw.js
self.addEventListener('fetch', function (e) {
  // respondWith - 通过它让 Service Worker 向浏览器返回数据
  e.respondWith(
  // 如果有 cache 则直接返回，否则通过 fetch 请求，并将请求结果返回给浏览器
    caches.match(e.request).then(function (cache) {
      return cache || fetch(e.request);
    }).catch(function (err) {
      return fetch(e.request);
    })
  );
});
</code></pre>

<p>当我们将资源缓存后，除非注销(unregister) sw.js、手动清除缓存，否则新的静态资源将无法缓存。解决这个问题的一个简单方法就是修改 <code class="highlighter-rouge">cacheName</code>。由于浏览器判断 sw.js 是否更新是通过字节方式，因此修改 cacheName 会重新触发 install 并缓存资源。此外，在 activate 事件中，我们需要检查 cacheName 是否变化，如果变化则表示有了新的缓存资源，原有缓存需要删除:</p>

<pre><code class="language-JS">// sw.js
// 监听 activate 事件，激活后通过 cache 的 key 来判断是否更新 cache 中的静态资源
self.addEventListener('activate', function (e) {
  var cachePromise = caches.keys().then(function (keys) {
    return Promise.all(keys.map(function (key) {
      if (key !== cacheName) {
        return caches.delete(key);
      }
    }));
  })
  e.waitUntil(cachePromise);
  return self.clients.claim();
});
</code></pre>

<p>另一方面 Web App 也会把 XHR 请求的数据缓存一份。而再次请求时，我们会优先使用本地缓存，然后向服务端请求数据，服务端返回数据后，基于该数据替换展示:</p>

<p><img src="https://user-gold-cdn.xitu.io/2018/4/8/162a560d35c15a67?w=567&amp;h=266&amp;f=png&amp;s=16946" alt="fetch" /></p>

<p>同时我们也可以改造下 <code class="highlighter-rouge">fetch</code>:</p>

<pre><code class="language-JS">// sw.js
var apiCacheName = 'api-0-1-1';
self.addEventListener('fetch', function (e) {
  // 需要缓存的请求
  var cacheRequestUrls = [
    '/book?'
  ];

  // 判断当前请求是否需要缓存
  var needCache = cacheRequestUrls.some(function (url) {
    return e.request.url.indexOf(url) &gt; -1;
  });

  /**** 这里是对 XHR 数据缓存的相关操作 ****/
  if (needCache) {
      // 需要缓存
    // 使用fetch请求数据，并将请求结果clone一份缓存到cache
    // 此部分缓存后在browser中使用全局变量caches获取
    caches.open(apiCacheName).then(function (cache) {
      return fetch(e.request).then(function (response) {
        // clone 方法拷贝一份响应数据，这样我们就可以对响应缓存进行各类操作而不用担心原响应信息被修改了
        cache.put(e.request.url, response.clone());
        return response;
      });
    });
  }
  /* ******************************* */

  else {
    // 非 api 请求，直接查询 cache
    e.respondWith(
      caches.match(e.request).then(function (cache) {
        return cache || fetch(e.request);
      }).catch(function (err) {
        return fetch(e.request);
      })
    );
  }
});
</code></pre>

<p>SW 配置好后，最后只剩下如何在 XHR 请求时有策略的使用缓存了，这一部分的改造全部集中于 <code class="highlighter-rouge">index.js</code>:</p>

<pre><code class="language-JS">function getApiDataFromCache(url) {
  // 仍然可以通过 caches 来访问缓存。为了保证渐进可用，我们需要先进行判断 'caches' in window
  if ('caches' in window) {
    return caches.match(url).then(function (cache) {
      // 判断是否命中缓存
      if (!cache) return;

      return cache.json();
    });
  }

  return Promise.resolve();
}
</code></pre>

<p>这样处理之后，我们可以感受到两个比较大的提升:</p>

<ul>
  <li>离线可用 - 如果我们之前访问过某些 URL，那么即使在离线的情况下，依然可以正常访问</li>
  <li>优化体验 - 提高访问速度。读取本地 cache 耗时相比于网络请求较低，在弱网情况下更明显</li>
</ul>

<h3 id="workbox">Workbox</h3>

<p><a href="https://developers.google.com/web/tools/workbox/modules/workbox-sw"><strong>Workbox</strong></a> 可以理解为 Google 官方 PWA 框架，它解决的就是用底层 API 写 PWA 太过复杂的问题。这里说的底层 API，指的就是去监听 SW 的 <code class="highlighter-rouge">install、active、fetch</code> 事件做相应逻辑处理等:</p>

<pre><code class="language-JS">// 首先引入 workbox 框架
importScripts('https://storage.googleapis.com/workbox-cdn/releases/4.1.1/workbox-sw.js');
workbox.precaching([
 // 注册成功后要立即缓存的资源列表
])

// 接下来定义 html 的缓存策略
workbox.routing.registerRoute(
 new RegExp('.*\.(?:js|css)'),
 workbox.strategies.cacheFirst()
);
</code></pre>

<p>对应的几种策略如下:</p>

<ul>
  <li><strong>Stale-While-Revalidate</strong></li>
</ul>

<p>The stale-while-revalidate pattern allows you to respond the request as quickly as possible with a cached response if available, falling back to the network request if it’s not cached. The network request is then used to update the cache.</p>

<pre><code class="language-JS">workbox.routing.registerRoute(
  new RegExp('https://your\.cdn\.com/'),
  workbox.strategies.staleWhileRevalidate()
);
</code></pre>

<p><img src="https://developers.google.com/web/tools/workbox/images/modules/workbox-strategies/stale-while-revalidate.png" alt="Stale-While-Revalidate" /></p>

<ul>
  <li><strong>Cache First</strong> (Cache Falling Back to Network)</li>
</ul>

<p>If there is a Response in the cache, the Request will be fulfilled using the cached response, the network will not be used at all. If there isn’t a cached response, the Request will be fulfilled by a a network request and the response will be cached so that the next request is served directly from the cache.</p>

<pre><code class="language-JS">workbox.routing.registerRoute(
  new RegExp('https://your\.img\.cdn\.com/'),
  workbox.strategies.cacheFirst({
    cacheName: 'example:img'
  })
);
</code></pre>

<p><img src="https://developers.google.com/web/tools/workbox/images/modules/workbox-strategies/cache-first.png" alt="Cache First" /></p>

<ul>
  <li><strong>Network First</strong> (Network Falling Back to Cache)</li>
</ul>

<p>For requests that are updating frequently, the network first strategy is the ideal solution. By default it will try and fetch the latest request from the network. If the request is successful, it’ll put the response in the cache. If the network fails to return a response, the caches response will be used.</p>

<pre><code class="language-JS">workbox.routing.registerRoute(
  new RegExp('/social-timeline/'),
  new workbox.strategies.NetworkFirst()
);
</code></pre>

<p><img src="https://developers.google.com/web/tools/workbox/images/modules/workbox-strategies/network-first.png" alt="Network First" /></p>

<ul>
  <li><strong>Network Only</strong></li>
</ul>

<pre><code class="language-JS">workbox.routing.registerRoute(
  new RegExp('/admin/'),
  new workbox.strategies.NetworkOnly()
);
</code></pre>

<p><img src="https://developers.google.com/web/tools/workbox/images/modules/workbox-strategies/network-only.png" alt="Network Only" /></p>

<ul>
  <li><strong>Cache Only</strong></li>
</ul>

<pre><code class="language-JS">workbox.routing.registerRoute(
  new RegExp('/app/v2/'),
  new workbox.strategies.CacheOnly()
);
</code></pre>

<p><img src="https://developers.google.com/web/tools/workbox/images/modules/workbox-strategies/cache-only.png" alt="Cach Only" /></p>

<h2 id="web-push-消息推送">Web Push 消息推送</h2>

<h2 id="notification-提醒">Notification 提醒</h2>

<h2 id="firebase">Firebase</h2>

<p><a href="https://firebase.google.com"><strong>Firebase</strong></a></p>

<h2 id="lighthouse">LightHouse</h2>

<p><strong>Lighthouse</strong> 是一个开源的自动化工具，用于改进网络应用的质量。 您可以将其作为一个 <a href="https://chrome.google.com/webstore/detail/lighthouse/blipmdconlkpinefehnmjammfjpmpbjk">Chrome 扩展程序</a>运行，或从命令行运行。 您为 Lighthouse 提供一个您要审查的网址，它将针对此页面运行一连串的测试，然后生成一个有关页面性能的报告。</p>

<pre><code class="language-SHELL"># 安装
npm install -g lighthouse

# 审查
lighthouse https://airhorner.com/
</code></pre>

<p><img src="https://developers.google.com/web/tools/lighthouse/images/report.png" alt="lighthouse" /></p>

<h2 id="参考链接">参考链接</h2>

<ol>
  <li><a href="https://developers.google.com/web/fundamentals/codelabs/your-first-pwapp/?hl=zh-cn">Your First Progressive Web App</a></li>
  <li><a href="https://developers.google.com/web/tools/workbox/modules/workbox-sw">Workbox</a></li>
  <li><a href="https://alienzhou.gitbook.io/learning-pwa/2018-kai-shi-ni-de-pwa-xue-xi-zhi-lv">2018，开始你的 PWA 学习之旅</a> By alienzhou</li>
</ol>
 
<div id="gitalk-container"></div>
<script>
    var gitalk = new Gitalk({
      enable: true,
      clientID: '020f142489f80c92b097',
      clientSecret: '1fa083372b44031cf1b8249251515c4e3d54c69d',
      repo: 'tate-young.github.io',
      owner: 'Tate-Young',
      admin: ['Tate-Young'],
      id: location.pathname,      // Ensure uniqueness and length less than 50
      distractionFreeMode: false  // Facebook-like distraction free mode
    })

    gitalk.render('gitalk-container')
</script>
<!-- disqus -->
<!-- <div id="disqus_thread"></div>
<script>
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */

    var disqus_config = function () {
        this.page.url = 'https://tate-young.github.io/2019/04/07/progressive-web-app.html';
        this.page.identifier = '/2019/04/07/progressive-web-app';
        this.page.title = 'PWA 简介';
    };

    (function () { // REQUIRED CONFIGURATION VARIABLE: EDIT THE SHORTNAME BELOW
        var d = document,
            s = d.createElement('script');

        s.src = '//tate.disqus.com/embed.js'; // IMPORTANT: Replace EXAMPLE with your forum shortname!

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the
    <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript> -->


            <!-- <p class="post-info">
			本文由 <a href="/">liberxue</a> 创作，采用 <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="external nofollow">知识共享署名4.0</a> 国际许可协议进行许可<br>本站文章除注明转载/出处外，均为本站原创或翻译，转载前请务必署名<br>最后编辑时间为:2019-04-07 23:40:00</p> -->
        </div>
    </article>

    <!-- <div class="related-post-lists">
	<div class="post-lists">
		<div class="post-lists-body">
					<div class="post-list-item">
				<div class="post-list-item-container">
					<div class="item-label">
						<div class="item-title"><a href="induction.html">归纳的随想</a></div>
						<div class="item-meta clearfix">
														<div class="item-meta-ico bg-ico-image" style="background: url('../usr/themes/pinghsu/images/bg-ico.png') no-repeat;background-size: 40px auto;"></div>
	                        							<div class="item-meta-cat"><a href="../category/thoughts/index.html">Thoughts</a></div>
						</div>
					</div>
				</div>
			</div>
				</div>
	</div>
</div> -->

    <!-- <footer class="footer bg-white">
	<div class="footer-social">
		<div class="footer-container clearfix">
			<div class="social-list">
	 <a class="social segmentfault" target="blank" href="https://segmentfault.com/u/liberxue" title="访问 LiberXue_Twitter" data-hover="Segmentfault">Segmentfault</a>
    <a class="social github" target="blank" href="https://github.com/liberxue" title="访问 LiberXue_Twitter" data-hover="GitHub">GitHub</a>
    <a class="social twitter" target="blank" href="http://twitter.com/liberxue" title="访问 LiberXue_Twitter" data-hover="Twitter">Twitter</a>
     <a class="social stackoverflow" target="blank" href="https://stackoverflow.com/users/6902190/liberxue" title="访问 LiberXue_stackoverflow" data-hover="StackOverflow">StackOverflow</a>
          <a class="social oschina" target="blank" href="https://my.oschina.net/bolanzw" title="访问 LiberXue_Oschina" data-hover="Oschina">Oschina</a>
     <a class="social rss" target="blank" href="/feed.xml"title="访问 LiberXue_RSS" data-hover="RSS">RSS</a>
	</div>
		</div>
	</div>
	<div class="footer-meta">
        <div class="footer-container">
            <div class="meta-item meta-copyright">
                <div class="meta-copyright-info">
                    <a href="/" class="info-logo">
                         <img src="http://localhost:4000/style/images/logo-liberxue.png"   title="访问 LiberXue_blog" data-hover="LiberXue_blog" alt="LiberXue_blog" /> </a>
                    <div class="info-text">
                        <p>Theme is <a href="http://www.liberxue.com/2017/08/03/Jekyllthemes.html" title="访问 Jekyll liberxue主题"  data-hover="Jekyll liberxue"target="_blank">Jekyll liberxue</a> by <a href="http://www.liberxue.com/about" target="_blank">liberxue</a></p>
                        <p>Powered by <a href="http://localhost:4000/tags/#Jekyll" title="Jekyll" data-hover="Jekyll" target="_blank" rel="nofollow">Jekyll</a></p>
                        <p>&copy; 2017 <a href="/feed.xml"  title="访问 liberxue blog RSS" data-hover="liberxue blog RSS">liberxue blog RSS</a></p>
                        <p>总计文章：篇</p>
                      <p>本blog已开源点击Fork</p><iframe src="http://ghbtns.com/github-btn.html?user=liberxue&repo=liberxue.github.io&type=fork&count=true" allowtransparency="true" frameborder="0" scrolling="0" width="95" height="20"></iframe>
                    </div>
                </div>
            </div>
            <div class="meta-item meta-posts">
                <h3 class="meta-title">置顶文章</h3>
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
            </div>
            <div class="meta-item meta-comments">
                <h3 class="meta-title">最新文章</h3>
          
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
            
      
    
</div>
		</div>
    </div>
</footer> -->
<script src="//cdn.bootcss.com/jquery/2.2.2/jquery.min.js"></script>
<script src="//cdn.bootcss.com/bootstrap-3-typeahead/4.0.2/bootstrap3-typeahead.js"></script>
<script src="/search/js/cb-search.js"></script>
<!-- <script src="/search/js/canvas.js"></script> -->

<script>
    $(function () {
        setTimeout(function () {
            $('code').removeClass('hljs');
            $('code').removeClass('language');
        }, 90);
    });
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>
    <!--liberxueconnnet-menu-->
    <div id="directory-content" class="directory-content">
        <div id="directory"></div>
    </div>
    <!--liberxueconnnet-menu-->
    <script>
        var postDirectoryBuild = function () {
            var postChildren = function children(childNodes, reg) {
                    var result = [],
                        isReg = typeof reg === 'object',
                        isStr = typeof reg === 'string',
                        node, i, len;
                    for (i = 0, len = childNodes.length; i < len; i++) {
                        node = childNodes[i];
                        if ((node.nodeType === 1 || node.nodeType === 9) &&
                            (!reg ||
                                isReg && reg.test(node.tagName.toLowerCase()) ||
                                isStr && node.tagName.toLowerCase() === reg)) {
                            result.push(node);
                        }
                    }
                    return result;
                },
                createPostDirectory = function (article, directory, isDirNum) {
                    var contentArr = [],
                        titleId = [],
                        levelArr, root, level,
                        currentList, list, li, link, i, len;
                    levelArr = (function (article, contentArr, titleId) {
                        var titleElem = postChildren(article.childNodes, /^h\d$/),
                            levelArr = [],
                            lastNum = 1,
                            lastRevNum = 1,
                            count = 0,
                            guid = 1,
                            id = 'directory' + (Math.random() + '').replace(/\D/, ''),
                            lastRevNum, num, elem;
                        while (titleElem.length) {
                            elem = titleElem.shift();
                            contentArr.push(elem.innerHTML);
                            num = +elem.tagName.match(/\d/)[0];
                            if (num > lastNum) {
                                levelArr.push(1);
                                lastRevNum += 1;
                            } else if (num === lastRevNum ||
                                num > lastRevNum && num <= lastNum) {
                                levelArr.push(0);
                                lastRevNum = lastRevNum;
                            } else if (num < lastRevNum) {
                                levelArr.push(num - lastRevNum);
                                lastRevNum = num;
                            }
                            count += levelArr[levelArr.length - 1];
                            lastNum = num;
                            elem.id = elem.id || (id + guid++);
                            titleId.push(elem.id);
                        }
                        if (count !== 0 && levelArr[0] === 1) levelArr[0] = 0;

                        return levelArr;
                    })(article, contentArr, titleId);
                    currentList = root = document.createElement('ul');
                    dirNum = [0];
                    for (i = 0, len = levelArr.length; i < len; i++) {
                        level = levelArr[i];
                        if (level === 1) {
                            list = document.createElement('ul');
                            if (!currentList.lastElementChild) {
                                currentList.appendChild(document.createElement('li'));
                            }
                            currentList.lastElementChild.appendChild(list);
                            currentList = list;
                            dirNum.push(0);
                        } else if (level < 0) {
                            level *= 2;
                            while (level++) {
                                if (level % 2) dirNum.pop();
                                currentList = currentList.parentNode;
                            }
                        }
                        dirNum[dirNum.length - 1]++;
                        li = document.createElement('li');
                        link = document.createElement('a');
                        link.href = '#' + titleId[i];
                        link.title = '访问' + titleId[i];
                        link.title = '访问' + titleId[i];
                        link.innerHTML = !isDirNum ? contentArr[i] :
                            dirNum.join('.') + ' ' + contentArr[i];
                        li.appendChild(link);
                        currentList.appendChild(li);
                    }
                    directory.appendChild(root);
                };
            createPostDirectory(document.getElementById('post-content'), document.getElementById('directory'), true);
        };
        postDirectoryBuild();
    </script>
    <script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
    <script>
        lang = hljs.initHighlightingOnLoad();
    </script>
</body>

</html>
