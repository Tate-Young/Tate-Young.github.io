
<!DOCTYPE>
<html lang="zh-cn" data-scribe-reduced-action-queue="true">
<head>
    <meta content='Vue æ·±å…¥å“åº”å¼åŸç† - Tate & Snow' name='title' />
    <meta content='Vue æ·±å…¥å“åº”å¼åŸç† - Tate & Snow' name='og:title' />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
    <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
    <title>Vue æ·±å…¥å“åº”å¼åŸç† - Tate & Snow</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>Vue æ·±å…¥å“åº”å¼åŸç† - Tate & Snow</title>
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Vue æ·±å…¥å“åº”å¼åŸç† - Tate & Snow">
<meta name="twitter:keywords" content="Vue æ·±å…¥å“åº”å¼åŸç† - Tate & Snow" property='og:description' />
<meta property="og:type" content="article">
<meta property="og:title" content="Vue æ·±å…¥å“åº”å¼åŸç† - Tate & Snow">
<meta name="og:keywords" content="Vue æ·±å…¥å“åº”å¼åŸç† - Tate & Snow|Vue æ·±å…¥å“åº”å¼åŸç†æ›´æ–°æ£€æµ‹å…³äº Vue å¦‚ä½•å®ç°å“åº”å¼ï¼Œå¯å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼Œç”¨ä¸€å¥è¯æ¦‚æ‹¬å³: å½“ä½ æŠŠä¸€ä¸ªæ™®é€šçš„ JavaScript å¯¹è±¡ä¼ ç»™ Vue å®ä¾‹çš„ data é€‰é¡¹ï¼ŒVue å°†éå†æ­¤å¯¹è±¡æ‰€æœ‰çš„å±æ€§ï¼Œå¹¶ä½¿ç”¨ Object.de..."
  property='og:description' />
<link rel="icon" type="image/png" href="http://localhost:2333/style/favicons/favicon.ico" />
<link href="http://localhost:2333/style/favicons/favicon.ico" rel="shortcut icon" type="image/png">
<link rel="canonical" href="http://localhost:2333/">
<link rel="alternate" type="application/rss+xml" title="Liberxue" href="http://localhost:2333/feed.xml">
<meta charset="UTF-8">
<link rel="manifest" href="/manifest.json">
<link rel="shortcut icon" href="http://localhost:2333/style/favicons/favicon.ico" type="image/x-icon">
<meta name="keywords" content="Vue æ·±å…¥å“åº”å¼åŸç†æ›´æ–°æ£€æµ‹å…³äº Vue å¦‚ä½•å®ç°å“åº”å¼ï¼Œå¯å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼Œç”¨ä¸€å¥è¯æ¦‚æ‹¬å³: å½“ä½ æŠŠä¸€ä¸ªæ™®é€šçš„ JavaScript å¯¹è±¡ä¼ ç»™ Vue å®ä¾‹çš„ data é€‰é¡¹ï¼ŒVue å°†éå†æ­¤å¯¹è±¡æ‰€æœ‰çš„å±æ€§ï¼Œå¹¶ä½¿ç”¨ Object.de..." property='og:description'
/>
<meta name="description" content="Tate & Snow's Github blog" />
<link href="https://cdn.bootcss.com/highlight.js/9.10.0/styles/xcode.min.css" rel="stylesheet">
<link href="http://localhost:2333/style/theme.css" rel="stylesheet"> 
<meta content='http://localhost:2333/2018/07/20/vue-reactivity-in-depth.html' property='og:url' />
<meta content="http://localhost:2333/2018/07/20/vue-reactivity-in-depth.html|Vue æ·±å…¥å“åº”å¼åŸç†æ›´æ–°æ£€æµ‹å…³äº Vue å¦‚ä½•å®ç°å“åº”å¼ï¼Œå¯å‚è€ƒå®˜æ–¹æ–‡æ¡£ï¼Œç”¨ä¸€å¥è¯æ¦‚æ‹¬å³: å½“ä½ æŠŠä¸€ä¸ªæ™®é€šçš„ JavaScript å¯¹è±¡ä¼ ç»™ Vue å®ä¾‹çš„ data é€‰é¡¹ï¼ŒVue å°†éå†æ­¤å¯¹è±¡æ‰€æœ‰çš„å±æ€§ï¼Œå¹¶ä½¿ç”¨ Object.de..." property='og:description'
/>
<meta content="article" property="og:type" /> 

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-136311746-1"></script>
<!-- <script async src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script> -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css"/>
<script>
  window.dataLayer = window.dataLayer || [];
  window.GA_TRACKING_ID = 'UA-136311746-1'
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('set', {
    'country': 'US',
    'currency': 'USD',
    'description': 'fuck',
  });
  gtag('config', GA_TRACKING_ID, {
    'custom_map': {
      'dimension1': 'post_title',
    },
    'post_title': 'test',
  });
</script>
<meta content="" property="fb:app_id" />
<!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Vue æ·±å…¥å“åº”å¼åŸç† | Tate &amp; Snow</title>
<meta name="generator" content="Jekyll v3.8.7" />
<meta property="og:title" content="Vue æ·±å…¥å“åº”å¼åŸç†" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Vue æ·±å…¥å“åº”å¼åŸç†" />
<meta property="og:description" content="Vue æ·±å…¥å“åº”å¼åŸç†" />
<link rel="canonical" href="http://localhost:2333/2018/07/20/vue-reactivity-in-depth.html" />
<meta property="og:url" content="http://localhost:2333/2018/07/20/vue-reactivity-in-depth.html" />
<meta property="og:site_name" content="Tate &amp; Snow" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2018-07-20T18:25:00+08:00" />
<script type="application/ld+json">
{"description":"Vue æ·±å…¥å“åº”å¼åŸç†","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:2333/2018/07/20/vue-reactivity-in-depth.html"},"@type":"BlogPosting","url":"http://localhost:2333/2018/07/20/vue-reactivity-in-depth.html","headline":"Vue æ·±å…¥å“åº”å¼åŸç†","dateModified":"2018-07-20T18:25:00+08:00","datePublished":"2018-07-20T18:25:00+08:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<script>
  (function (d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s);
    js.id = id;
    js.src = "//connect.facebook.net/en_GB/all.js#xfbml=1&appId=";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
</script>

</head>

<body class="dark-theme" gtools_scp_screen_capture_injected="true">
    <header id="header" class="header bg-white">
        <div class="navbar-container">
            <a href="Javascript:;" onclick="onClickLogo()" title="è®¿é—® Tate & Snow" class="navbar-logo menu-logo">
                <img src="http://localhost:2333/style/images/tate.png" alt="Tate & Snow"> </a>
            <!-- <a href="/?tate" title="è®¿é—® Tate & Snow" class="navbar-logo">Tate & Snow</a>   -->
            <div class="navbar-menu">
                
                  <a class=" menu-item-categories " href="Javascript:;" onclick="onClickMenu('é¦–é¡µ', '/')" title="è®¿é—® é¦–é¡µ" data-hover="é¦–é¡µ">é¦–é¡µ</a>
                
                  <a class=" menu-item-categories " href="Javascript:;" onclick="onClickMenu('å‰ç«¯', '/front')" title="è®¿é—® å‰ç«¯" data-hover="å‰ç«¯">å‰ç«¯</a>
                
                  <a class=" menu-item-categories " href="Javascript:;" onclick="onClickMenu('å†å²', '/history')" title="è®¿é—® å†å²" data-hover="å†å²">å†å²</a>
                
                  <a class=" menu-item-categories " href="Javascript:;" onclick="onClickMenu('å…¶ä»–', '/other')" title="è®¿é—® å…¶ä»–" data-hover="å…¶ä»–">å…¶ä»–</a>
                
                  <a class=" menu-item-categories " href="Javascript:;" onclick="onClickMenu('æ ‡ç­¾', '/tags')" title="è®¿é—® æ ‡ç­¾" data-hover="æ ‡ç­¾">æ ‡ç­¾</a>
                
                  <a class=" menu-item-about " href="Javascript:;" onclick="onClickMenu('å…³äº', '/README')" title="è®¿é—® å…³äº" data-hover="å…³äº">å…³äº</a>
                
            </div>
            <!-- <div class="navbar-menu">
                
                <a href="http://localhost:2333/">é¦–é¡µ</a>
                
                <a href="http://localhost:2333/front">å‰ç«¯</a>
                
                <a href="http://localhost:2333/history">å†å²</a>
                
                <a href="http://localhost:2333/other">å…¶ä»–</a>
                
                <a href="http://localhost:2333/tags">æ ‡ç­¾</a>
                
                <a href="http://localhost:2333/README">å…³äº</a>
                
            </div> -->
            <div class="navbar-search menu-item-search" onclick="onClickSearch()">
                <span class="icon-search"></span>
                <form id="cb-search-btn" role="search">
                    <span class="search-box">
                        <input type="text" class="input" id="cb-search-content" required="true" placeholder="æ ‡é¢˜ æ ‡ç­¾..." maxlength="30" autocomplete="off">
                    </span>
                </form>
            </div>
            <div class="navbar-mobile-menu" onclick="">
                <span class="icon-menu cross">
                    <span class="middle"></span>
                </span>
                <ul>
                    
                    <li>
                        <a class="menu-item-categories" href="Javascript:;" onclick="onClickMenu('é¦–é¡µ', 'http://localhost:2333/')">é¦–é¡µ</a>
                    </li>
                    
                    <li>
                        <a class="menu-item-categories" href="Javascript:;" onclick="onClickMenu('å‰ç«¯', 'http://localhost:2333/front')">å‰ç«¯</a>
                    </li>
                    
                    <li>
                        <a class="menu-item-categories" href="Javascript:;" onclick="onClickMenu('å†å²', 'http://localhost:2333/history')">å†å²</a>
                    </li>
                    
                    <li>
                        <a class="menu-item-categories" href="Javascript:;" onclick="onClickMenu('å…¶ä»–', 'http://localhost:2333/other')">å…¶ä»–</a>
                    </li>
                    
                    <li>
                        <a class="menu-item-categories" href="Javascript:;" onclick="onClickMenu('æ ‡ç­¾', 'http://localhost:2333/tags')">æ ‡ç­¾</a>
                    </li>
                    
                    <li>
                        <a class="menu-item-categories" href="Javascript:;" onclick="onClickMenu('å…³äº', 'http://localhost:2333/README')">å…³äº</a>
                    </li>
                    
                </ul>
            </div>
        </div>
    </header>
    <a href="#header" class="back-to-top" onclick="onClickTop('Vue æ·±å…¥å“åº”å¼åŸç†')">â¤´Topâ¤´</a>
    <div class="post-header-thumb bg-white}">
        <div class="post-header-thumb-op"></div>
        <div class="post-header-thumb">
            <div class="post-header-thumb-container">
                <h1 class="post-title" itemprop="name headline">
                    Vue æ·±å…¥å“åº”å¼åŸç†</h1>
                <div class="post-data">
                    <time datetime="2018-07-20 18:25:00" itemprop="datePublished">
                      å‘å¸ƒæ—¶é—´ï¼š2018-07-20 18:25:00
                      &nbsp;&nbsp;&nbsp;
                      
                    </time>
                    <a onclick="onClickCategory('å‰ç«¯')" href="Javascript:;" title="è®¿é—® å‰ç«¯" data-hover="åšå®¢åˆ†ç±»: å‰ç«¯">åšå®¢åˆ†ç±»: å‰ç«¯</a>
                    <!-- <a href="#read"> é˜…è¯»æ¬¡æ•°: comments</a>  -->
                </div>
                <div class="post-tags">
                       
                    <a class="menu-item-tags" href="Javascript:;" onclick="onClickTag('Vue')" title="è®¿é—®Vue" data-hover="Vue">
                        Vue
                        <span>(5)</span>
                        
                    </a>
                       
                </div>
            </div>
        </div>
    </div>
    <article class="main-content post-page" itemscope itemtype="http://schema.org/Article">
        <div class="post-header">
            <h1 class="post-title" itemprop="name headline">
                Vue æ·±å…¥å“åº”å¼åŸç†</h1>
            <div class="post-data">
                <time datetime="2018-07-20 18:25:00" itemprop="datePublished">2018-07-20 18:25:00</time>
            </div>
        </div>
        <div id="post-content" class="post-content" itemprop="articleBody">
            <p class="post-tags">
                   
                <a href="Javascript:;" onclick="onClickTag('Vue')" title="è®¿é—®Vue" data-hover="Vue">
                    Vue
                    <span>(5)</span>
                    </a>
                   
            </p>
            <h1 id="vue-æ·±å…¥å“åº”å¼åŸç†">Vue æ·±å…¥å“åº”å¼åŸç†</h1>

<h2 id="æ›´æ–°æ£€æµ‹">æ›´æ–°æ£€æµ‹</h2>

<p>å…³äº Vue å¦‚ä½•å®ç°å“åº”å¼ï¼Œå¯<a href="https://cn.vuejs.org/v2/guide/reactivity.html">å‚è€ƒå®˜æ–¹æ–‡æ¡£</a>ï¼Œç”¨ä¸€å¥è¯æ¦‚æ‹¬å³: å½“ä½ æŠŠä¸€ä¸ªæ™®é€šçš„ JavaScript å¯¹è±¡ä¼ ç»™ Vue å®ä¾‹çš„ data é€‰é¡¹ï¼ŒVue å°†éå†æ­¤å¯¹è±¡æ‰€æœ‰çš„å±æ€§ï¼Œå¹¶ä½¿ç”¨ <strong>Object.defineProperty</strong> æŠŠè¿™äº›å±æ€§å…¨éƒ¨è½¬ä¸º <strong>getter/setter</strong>ã€‚æ¯ä¸ªç»„ä»¶å®ä¾‹éƒ½æœ‰ç›¸åº”çš„ <strong>watcher</strong> å®ä¾‹å¯¹è±¡ï¼Œå®ƒä¼šåœ¨ç»„ä»¶æ¸²æŸ“çš„è¿‡ç¨‹ä¸­æŠŠå±æ€§è®°å½•ä¸ºä¾èµ–ï¼Œä¹‹åå½“ä¾èµ–é¡¹çš„ setter è¢«è°ƒç”¨æ—¶ï¼Œä¼šé€šçŸ¥ watcher é‡æ–°è®¡ç®—ï¼Œä»è€Œè‡´ä½¿å®ƒå…³è”çš„ç»„ä»¶å¾—ä»¥æ›´æ–°ã€‚</p>

<p>å…³äºå¦‚ä½•ç†è§£ Object.definePropertyï¼Œå¯ä»¥å‚è€ƒä»¥ä¸‹ç¤ºä¾‹:</p>

<pre><code class="language-JS">var obj = {};
var name;
Object.defineProperty(obj, 'name', {
  get: function() {
    console.log('get name');
    return name;
  },
  set: function(newVal) {
    console.log('set name:' + newVal);
    name = newVal;
  }
});
obj.name; // get name
obj.name = 'tate'; // set name: tate
</code></pre>

<p><img src="https://cn.vuejs.org/images/data.png" alt="Vue å“åº”å¼åŸç†" /></p>

<h3 id="æ•°ç»„">æ•°ç»„</h3>

<p>Vue åŒ…å«ä¸€ç»„è§‚å¯Ÿæ•°ç»„çš„<strong>å˜å¼‚æ–¹æ³•</strong>ï¼Œæ‰€ä»¥å®ƒä»¬ä¹Ÿå°†ä¼šè§¦å‘è§†å›¾æ›´æ–°ã€‚è¿™äº›æ–¹æ³•æ¯”å¦‚æœ‰ pushã€popã€spliceã€sort ç­‰ï¼›ç›¸å filterã€sliceã€concat ç­‰æ–¹æ³•ä¸ä¼šæ”¹å˜åŸæ•°ç»„ï¼Œæ‰€ä»¥ä¸ä¼šè§¦å‘è§†å›¾æ›´æ–°ï¼Œæ˜¯éå¸¸é«˜æ•ˆçš„æ“ä½œã€‚ä¸¾ä¸ªæ —å­ ğŸŒ°:</p>

<pre><code class="language-JS">var vm = new Vue({
  data: {
    items: ['a', 'b', 'c']
  }
})
vm.items[1] = 'x' // ä¸æ˜¯å“åº”æ€§çš„
vm.items.length = 2 // ä¸æ˜¯å“åº”æ€§çš„
</code></pre>

<p>è§£å†³æ–¹æ¡ˆ:</p>

<pre><code class="language-JS">// Vue.set
Vue.set(vm.items, indexOfItem, newValue)

// ç­‰ä»·äº vm.$set å®ä¾‹æ–¹æ³•
vm.$set(vm.items, indexOfItem, newValue)

// æˆ–è€…è½¬æ¢ä¸ºå˜å¼‚æ–¹æ³•
vm.items.splice(indexOfItem, 1, newValue)
</code></pre>

<h3 id="å¯¹è±¡">å¯¹è±¡</h3>

<p>Vue ä¸èƒ½æ£€æµ‹å¯¹è±¡å±æ€§çš„æ·»åŠ æˆ–åˆ é™¤:</p>

<pre><code class="language-JS">var vm = new Vue({
  data: {
    a: 1 // `vm.a` ç°åœ¨æ˜¯å“åº”å¼çš„
  }
})

vm.b = 2 // `vm.b` ä¸æ˜¯å“åº”å¼çš„
</code></pre>

<p>å½“ç„¶å¯ä»¥é‡‡ç”¨ä¸Šè¿°æ•°ç»„ä¸­çš„ Vue.set æ–¹æ³•ï¼Œå¦‚æœåˆ©ç”¨ Object.assign æ–¹æ³•æ·»åŠ æ–°çš„å“åº”å¼å±æ€§:</p>

<pre><code class="language-JS">// bad
Object.assign(vm.userProfile, {
  age: 27,
  favoriteColor: 'Vue Green'
})

// good
vm.userProfile = Object.assign({}, vm.userProfile, {
  age: 27,
  favoriteColor: 'Vue Green'
})
</code></pre>

<h3 id="nexttick">$nextTick</h3>

<p>Vue å¼‚æ­¥æ‰§è¡Œ DOM æ›´æ–°ã€‚åªè¦è§‚å¯Ÿåˆ°æ•°æ®å˜åŒ–ï¼ŒVue å°†å¼€å¯ä¸€ä¸ªé˜Ÿåˆ—ï¼Œå¹¶ç¼“å†²åœ¨åŒä¸€äº‹ä»¶å¾ªç¯ä¸­å‘ç”Ÿçš„æ‰€æœ‰æ•°æ®æ”¹å˜ã€‚å¦‚æœåŒä¸€ä¸ª watcher è¢«å¤šæ¬¡è§¦å‘ï¼Œåªä¼šè¢«æ¨å…¥åˆ°é˜Ÿåˆ—ä¸­ä¸€æ¬¡ã€‚è¿™ç§åœ¨ç¼“å†²æ—¶å»é™¤é‡å¤æ•°æ®å¯¹äºé¿å…ä¸å¿…è¦çš„è®¡ç®—å’Œ DOM æ“ä½œä¸Šéå¸¸é‡è¦ã€‚ç„¶åï¼Œåœ¨ä¸‹ä¸€ä¸ªçš„äº‹ä»¶å¾ªç¯â€œtickâ€ä¸­ï¼ŒVue åˆ·æ–°é˜Ÿåˆ—å¹¶æ‰§è¡Œå®é™… (å·²å»é‡çš„) å·¥ä½œã€‚Vue åœ¨å†…éƒ¨å°è¯•å¯¹å¼‚æ­¥é˜Ÿåˆ—ä½¿ç”¨åŸç”Ÿçš„ Promise.then å’Œ MessageChannelï¼Œå¦‚æœæ‰§è¡Œç¯å¢ƒä¸æ”¯æŒï¼Œä¼šé‡‡ç”¨ setTimeout(fn, 0) ä»£æ›¿ã€‚</p>

<p>ä¾‹å¦‚ï¼Œå½“ä½ è®¾ç½® vm.someData = â€˜new valueâ€™ ï¼Œè¯¥ç»„ä»¶ä¸ä¼šç«‹å³é‡æ–°æ¸²æŸ“ã€‚å½“åˆ·æ–°é˜Ÿåˆ—æ—¶ï¼Œç»„ä»¶ä¼šåœ¨äº‹ä»¶å¾ªç¯é˜Ÿåˆ—æ¸…ç©ºæ—¶çš„ä¸‹ä¸€ä¸ªâ€œtickâ€æ›´æ–°ã€‚ä¸ºäº†åœ¨æ•°æ®å˜åŒ–ä¹‹åç­‰å¾… Vue å®Œæˆæ›´æ–° DOM ï¼Œå¯ä»¥åœ¨æ•°æ®å˜åŒ–ä¹‹åç«‹å³ä½¿ç”¨ <strong>Vue.nextTick(callback)</strong> ã€‚è¿™æ ·å›è°ƒå‡½æ•°åœ¨ DOM æ›´æ–°å®Œæˆåå°±ä¼šè°ƒç”¨ã€‚</p>

<pre><code class="language-JS">var vm = new Vue({
  el: '#example',
  data: {
    message: '123'
  }
})
vm.message = 'new message' // æ›´æ”¹æ•°æ®
vm.$el.textContent === 'new message' // false
Vue.nextTick(function () {
  vm.$el.textContent === 'new message' // true
})
</code></pre>

<p>åœ¨ç»„ä»¶å†…ä½¿ç”¨ <strong>vm.$nextTick()</strong> å®ä¾‹æ–¹æ³•ç‰¹åˆ«æ–¹ä¾¿ï¼Œå› ä¸ºå®ƒä¸éœ€è¦å…¨å±€ Vue ï¼Œå¹¶ä¸”å›è°ƒå‡½æ•°ä¸­çš„ this å°†è‡ªåŠ¨ç»‘å®šåˆ°å½“å‰çš„ Vue å®ä¾‹ä¸Š:</p>

<pre><code class="language-JS">Vue.component('example', {
  template: '&lt;span&gt;&lt;/span&gt;',
  data: function () {
    return {
      message: 'æ²¡æœ‰æ›´æ–°'
    }
  },
  methods: {
    updateMessage: function () {
      this.message = 'æ›´æ–°å®Œæˆ'
      console.log(this.$el.textContent) // =&gt; 'æ²¡æœ‰æ›´æ–°'
      this.$nextTick(function () {
        console.log(this.$el.textContent) // =&gt; 'æ›´æ–°å®Œæˆ'
      })
    }
  }
})
</code></pre>

<h2 id="æ·±å…¥å“åº”å¼">æ·±å…¥å“åº”å¼</h2>

<p>Vue æ•°æ®å“åº”å¼å˜åŒ–ä¸»è¦æ¶‰åŠ <strong>Observer</strong>ã€<strong>Watcher</strong>ã€<strong>Dep</strong> è¿™ä¸‰ä¸ªä¸»è¦çš„ç±»ï¼Œä¸‹é¢æ ¹æ®<a href="https://github.com/huangzhuangjia/Vue-learn/blob/master/core/instance/init.js"><strong>æºç </strong></a>è¿›è¡Œç®€å•çš„åˆ†æã€‚</p>

<h3 id="å®ä¾‹åˆå§‹åŒ–">å®ä¾‹åˆå§‹åŒ–</h3>

<pre><code class="language-JS">initLifecycle(vm) // åˆå§‹åŒ–ç”Ÿå‘½å‘¨æœŸ
initEvents(vm) // åˆå§‹åŒ–äº‹ä»¶
initRender(vm) // åˆå§‹åŒ– render
callHook(vm, 'beforeCreate') // è°ƒç”¨ beforeCreate é’©å­å‡½æ•°å¹¶ä¸”è§¦å‘ beforeCreate é’©å­äº‹ä»¶
initInjections(vm) // resolve injections before data/props
initState(vm) // åˆå§‹åŒ– propsã€methodsã€dataã€computed ä¸ watch
initProvide(vm) // resolve provide after data/props
callHook(vm, 'created') // è°ƒç”¨ created é’©å­å‡½æ•°å¹¶ä¸”è§¦å‘ created é’©å­äº‹ä»¶
</code></pre>

<h3 id="initstate-åˆå§‹åŒ–">initState åˆå§‹åŒ–</h3>

<p><strong>initState</strong> æ–¹æ³•ä¸»è¦ç”¨æ¥åˆå§‹åŒ– propsã€methodsã€dataã€computed ä¸ watchï¼Œå…·ä½“å®ç°æ–¹å¼å¦‚ä¸‹:</p>

<pre><code class="language-JS">export function initState (vm: Component) {
  vm._watchers = []
  const opts = vm.$options
  if (opts.props) initProps(vm, opts.props)
  if (opts.methods) initMethods(vm, opts.methods)
  if (opts.data) {
    initData(vm)
  } else {
    /* è¯¥ç»„ä»¶æ²¡æœ‰ data çš„æ—¶å€™ç»‘å®šä¸€ä¸ªç©ºå¯¹è±¡ */
    observe(vm._data = {}, true /* asRootData */)
  }
  if (opts.computed) initComputed(vm, opts.computed)
  if (opts.watch) initWatch(vm, opts.watch)
}
...
/* åˆå§‹åŒ– data */
function initData (vm: Component) {
  let data = vm.$options.data
  data = vm._data = typeof data === 'function'
    ? getData(data, vm)
    : data || {}defi
  ...
  while (i--) { // éå†dataä¸­çš„æ•°æ®
    /* ä¿è¯ data ä¸­çš„ key ä¸ä¸ props ä¸­çš„ key é‡å¤ï¼Œprops ä¼˜å…ˆï¼Œå¦‚æœæœ‰å†²çªä¼šäº§ç”Ÿ warning */
    if (props &amp;&amp; hasOwn(props, keys[i])) {
      process.env.NODE_ENV !== 'production' &amp;&amp; warn(
        `The data property "${keys[i]}" is already declared as a prop. ` +
        `Use prop default value instead.`,
        vm
      )
    } else if (!isReserved(keys[i])) {
      /* å°† data ä¸Šé¢çš„å±æ€§ä»£ç†åˆ°äº† vm å®ä¾‹ä¸Š */
      proxy(vm, `_data`, keys[i])
    }
  }
  /* è¿™é‡Œé€šè¿‡ observe å®ä¾‹åŒ– Observe å¯¹è±¡ï¼Œå¼€å§‹å¯¹æ•°æ®è¿›è¡Œç»‘å®šï¼ŒasRootData ç”¨æ¥æ ¹æ•°æ®ï¼Œç”¨æ¥è®¡ç®—å®ä¾‹åŒ–æ ¹æ•°æ®çš„ä¸ªæ•°ï¼Œä¸‹é¢ä¼šè¿›è¡Œé€’å½’ observe è¿›è¡Œå¯¹æ·±å±‚å¯¹è±¡çš„ç»‘å®šã€‚åˆ™ asRootData ä¸ºé true */
  observe(data, true /* asRootData */)
}
</code></pre>

<h3 id="observe-åˆ›å»º-observer-å®ä¾‹">observe åˆ›å»º Observer å®ä¾‹</h3>

<p><strong>observe</strong> æ–¹æ³•å¯¹ data å®šä¹‰çš„æ¯ä¸ªå±æ€§è¿›è¡Œ getter/setter æ“ä½œï¼Œè¿™é‡Œå°±æ˜¯ Vue å®ç°å“åº”å¼çš„åŸºç¡€:</p>

<pre><code class="language-JS"> /* å°è¯•åˆ›å»ºä¸€ä¸ª Observer å®ä¾‹ï¼ˆ__ob__ï¼‰ï¼Œå¦‚æœæˆåŠŸåˆ›å»º Observer å®ä¾‹åˆ™è¿”å›æ–°çš„ Observerå®ä¾‹ï¼Œå¦åˆ™è¿”å›ç°æœ‰çš„ Observer å®ä¾‹ã€‚*/
export function observe (value: any, asRootData: ?boolean): Observer | void {
  if (!isObject(value)) {
    return
  }
  let ob: Observer | void
  /*è¿™é‡Œç”¨ __ob__ è¿™ä¸ªå±æ€§æ¥åˆ¤æ–­æ˜¯å¦å·²ç»æœ‰ Observer å®ä¾‹ */
  if (hasOwn(value, '__ob__') &amp;&amp; value.__ob__ instanceof Observer) {
    ob = value.__ob__
  } else if (
    /* è¿™é‡Œçš„åˆ¤æ–­æ˜¯ä¸ºäº†ç¡®ä¿ value æ˜¯å•çº¯çš„å¯¹è±¡ï¼Œè€Œä¸æ˜¯å‡½æ•°æˆ–è€…æ˜¯ Regexp ç­‰æƒ…å†µã€‚è€Œä¸”è¯¥å¯¹è±¡åœ¨ shouldConvert çš„æ—¶å€™æ‰ä¼šè¿›è¡Œ Observerã€‚è¿™æ˜¯ä¸€ä¸ªæ ‡è¯†ä½ï¼Œé¿å…é‡å¤å¯¹ value è¿›è¡Œ Observer */
    observerState.shouldConvert &amp;&amp;
    !isServerRendering() &amp;&amp;
    (Array.isArray(value) || isPlainObject(value)) &amp;&amp;
    Object.isExtensible(value) &amp;&amp;
    !value._isVue
  ) {
    ob = new Observer(value) // å°† data è½¬å˜å¯ä»¥æˆè§‚å¯Ÿçš„
  }
  if (asRootData &amp;&amp; ob) {
     /* å¦‚æœæ˜¯æ ¹æ•°æ®åˆ™è®¡æ•°ï¼Œåé¢ Observer ä¸­çš„ observe çš„ asRootData é true */
    ob.vmCount++
  }
  return ob
}
</code></pre>

<h3 id="observer-ç±»">Observer ç±»</h3>

<p><strong>Observer</strong> ç±»æ˜¯å°†æ¯ä¸ªç›®æ ‡å¯¹è±¡ data çš„é”®å€¼è½¬æ¢æˆ getter/setter å½¢å¼:</p>

<pre><code class="language-JS">export class Observer {
  value: any;
  dep: Dep;
  vmCount: number; // number of vms that has this object as root $data
  constructor (value: any) {
    this.value = value
    this.dep = new Dep()
    this.vmCount = 0
    /* å°† Observer å®ä¾‹ç»‘å®šåˆ° data çš„ __ob__ å±æ€§ä¸Šé¢å»ï¼Œä¹‹å‰è¯´è¿‡ observe çš„æ—¶å€™ä¼šå…ˆæ£€æµ‹æ˜¯å¦å·²ç»æœ‰ __ob__ å¯¹è±¡å­˜æ”¾ Observer å®ä¾‹äº†ï¼Œdefæ–¹æ³•å®šä¹‰å¯ä»¥å‚è€ƒ/src/core/util/lang.js */
    def(value, '__ob__', this)
    if (Array.isArray(value)) {
      /* å¦‚æœæ˜¯æ•°ç»„ï¼Œå°†ä¿®æ”¹åå¯ä»¥æˆªè·å“åº”çš„æ•°ç»„æ–¹æ³•æ›¿æ¢æ‰è¯¥æ•°ç»„çš„åŸå‹ä¸­çš„åŸç”Ÿæ–¹æ³•ï¼Œè¾¾åˆ°ç›‘å¬æ•°ç»„æ•°æ®å˜åŒ–å“åº”çš„æ•ˆæœã€‚è¿™é‡Œå¦‚æœå½“å‰æµè§ˆå™¨æ”¯æŒ __proto__ å±æ€§ï¼Œåˆ™ç›´æ¥è¦†ç›–å½“å‰æ•°ç»„å¯¹è±¡åŸå‹ä¸Šçš„åŸç”Ÿæ•°ç»„æ–¹æ³•ï¼Œå¦‚æœä¸æ”¯æŒè¯¥å±æ€§ï¼Œåˆ™ç›´æ¥è¦†ç›–æ•°ç»„å¯¹è±¡çš„åŸå‹ã€‚*/
      const augment = hasProto
        ? protoAugment  /* ç›´æ¥è¦†ç›–åŸå‹çš„æ–¹æ³•æ¥ä¿®æ”¹ç›®æ ‡å¯¹è±¡ */
        : copyAugment   /* å®šä¹‰ï¼ˆè¦†ç›–ï¼‰ç›®æ ‡å¯¹è±¡æˆ–æ•°ç»„çš„æŸä¸€ä¸ªæ–¹æ³• */
      augment(value, arrayMethods, arrayKeys)
      /* å¦‚æœæ˜¯æ•°ç»„åˆ™éœ€è¦éå†æ•°ç»„çš„æ¯ä¸€ä¸ªæˆå‘˜è¿›è¡Œ observe */
      this.observeArray(value)
    } else {
      /* å¦‚æœæ˜¯å¯¹è±¡åˆ™ç›´æ¥ walk è¿›è¡Œç»‘å®š */
      this.walk(value)
    },
    walk (obj: Object) {
      const keys = Object.keys(obj)
      /* walk æ–¹æ³•ä¼šéå†å¯¹è±¡çš„æ¯ä¸€ä¸ªå±æ€§è¿›è¡Œ defineReactive ç»‘å®š*/
      for (let i = 0; i &lt; keys.length; i++) {
        defineReactive(obj, keys[i], obj[keys[i]])
      }
    }

    /**
    * Observe a list of Array items.
    */
    /*å¯¹ä¸€ä¸ªæ•°ç»„çš„æ¯ä¸€ä¸ªæˆå‘˜è¿›è¡Œobserve*/
    observeArray (items: Array&lt;any&gt;) {
      for (let i = 0, l = items.length; i &lt; l; i++) {
        /*æ•°ç»„éœ€è¦éå†æ¯ä¸€ä¸ªæˆå‘˜è¿›è¡Œobserve*/
        observe(items[i])
      }
    }
  }
}
</code></pre>

<h3 id="definereactive-è®¾ç½®å­˜å–å™¨">defineReactive è®¾ç½®å­˜å–å™¨</h3>

<p>è‡³æ­¤ï¼Œæ‰€æœ‰çš„æ•°æ®éƒ½å·²ç»è½¬æ¢ä¸º Observer å¯¹è±¡:</p>

<pre><code class="language-JS">export function defineReactive (
  obj: Object,
  key: string,
  val: any,
  customSetter?: Function
) {
  /* åœ¨é—­åŒ…ä¸­å®šä¹‰ä¸€ä¸ª dep å¯¹è±¡*/
  const dep = new Dep()
  const property = Object.getOwnPropertyDescriptor(obj, key)
  if (property &amp;&amp; property.configurable === false) {
    return
  }
  /* å¦‚æœä¹‹å‰è¯¥å¯¹è±¡å·²ç»é¢„è®¾äº† getter ä»¥åŠ setter å‡½æ•°åˆ™å°†å…¶å–å‡ºæ¥ï¼Œæ–°å®šä¹‰çš„ getter/setter ä¸­ä¼šå°†å…¶æ‰§è¡Œï¼Œä¿è¯ä¸ä¼šè¦†ç›–ä¹‹å‰å·²ç»å®šä¹‰çš„ getter/setter */
  // cater for pre-defined getter/setters
  const getter = property &amp;&amp; property.get
  const setter = property &amp;&amp; property.set
  /* å¯¹è±¡çš„å­å¯¹è±¡é€’å½’è¿›è¡Œ observe å¹¶è¿”å›å­èŠ‚ç‚¹çš„ Observer å¯¹è±¡ */
  let childOb = observe(val)
  Object.defineProperty(obj, key, {
    enumerable: true,
    configurable: true,
    get: function reactiveGetter () {
      const value = getter ? getter.call(obj) : val /* å¦‚æœåŸæœ¬å¯¹è±¡æ‹¥æœ‰ getter æ–¹æ³•åˆ™æ‰§è¡Œ */
      if (Dep.target) {
        dep.depend() /* è¿›è¡Œä¾èµ–æ”¶é›†ï¼Œå³å°†å½“å‰çš„ Watcher å¯¹è±¡å­˜å…¥ dep çš„ subs ä¸­ */
        if (childOb) {
          /* å­å¯¹è±¡è¿›è¡Œä¾èµ–æ”¶é›†ï¼Œå…¶å®å°±æ˜¯å°†åŒä¸€ä¸ª watcher è§‚å¯Ÿè€…å®ä¾‹æ”¾è¿›äº†ä¸¤ä¸ª depend ä¸­ï¼Œä¸€ä¸ªæ˜¯æ­£åœ¨æœ¬èº«é—­åŒ…ä¸­çš„ dependï¼Œå¦ä¸€ä¸ªæ˜¯å­å…ƒç´ çš„depend */
          childOb.dep.depend()
        }
        if (Array.isArray(value)) {
          /* æ˜¯æ•°ç»„åˆ™éœ€è¦å¯¹æ¯ä¸€ä¸ªæˆå‘˜éƒ½è¿›è¡Œä¾èµ–æ”¶é›†ï¼Œå¦‚æœæ•°ç»„çš„æˆå‘˜è¿˜æ˜¯æ•°ç»„ï¼Œåˆ™é€’å½’ */
          dependArray(value)
        }
      }
      return value
    },
    set: function reactiveSetter (newVal) {
      /* é€šè¿‡ getter æ–¹æ³•è·å–å½“å‰å€¼ï¼Œä¸æ–°å€¼è¿›è¡Œæ¯”è¾ƒï¼Œä¸€è‡´åˆ™ä¸éœ€è¦æ‰§è¡Œä¸‹é¢çš„æ“ä½œ */
      const value = getter ? getter.call(obj) : val
      ...
      if (setter) {
        /* å¦‚æœåŸæœ¬å¯¹è±¡æ‹¥æœ‰ setter æ–¹æ³•åˆ™æ‰§è¡Œ setter */
        setter.call(obj, newVal)
      } else {
        val = newVal
      }
      /* æ–°çš„å€¼éœ€è¦é‡æ–°è¿›è¡Œ observeï¼Œä¿è¯æ•°æ®å“åº”å¼ */
      childOb = observe(newVal)
      /* dep å¯¹è±¡é€šçŸ¥æ‰€æœ‰çš„è§‚å¯Ÿè€… */
      dep.notify()
    }
  })
}
</code></pre>

<p>æ”¶é›†ä¾èµ–çš„ä½œç”¨å…¶å®å°±æ˜¯ getter æ—¶æ”¶é›†ä¾èµ–çš„ watcherï¼Œç„¶ååœ¨ setter æ“ä½œæ—¶å€™é€šè¿‡ dep å»é€šçŸ¥ watcherï¼Œæ­¤æ—¶ watcher å°±æ‰§è¡Œæ›´æ–°ã€‚å¦å¤– Dep.target çš„å«ä¹‰å¯ä»¥ä»ä»¥ä¸‹ç¤ºä¾‹çœ‹å‡ºï¼Œtext3 å¹¶æ²¡æœ‰è¢«ç»‘å®šåˆ°æ¨¡æ¿ä¸­ï¼Œä¸ºäº†æé«˜ä»£ç æ‰§è¡Œæ•ˆç‡ï¼Œæ”¶é›†åªåœ¨å®é™…é¡µé¢ä¸­ç”¨åˆ°çš„ data æ•°æ®ï¼Œç„¶åæ‰“ä¸Šæ ‡è®°ï¼Œè¿™é‡Œå°±æ˜¯æ ‡è®°ä¸º Dep.target:</p>

<pre><code class="language-JS">new Vue({
  template:
    `&lt;div&gt;
      &lt;span&gt;text1:&lt;/span&gt; 
      &lt;span&gt;text2:&lt;/span&gt; 
    &lt;div&gt;`,
  data: {
    text1: 'text1',
    text2: 'text2',
    text3: 'text3'
  }
});
</code></pre>

<h3 id="dep-ä¾èµ–">Dep ä¾èµ–</h3>

<p>Dep ç±»æ˜¯ Watcher å’Œ Observer ä¹‹é—´çš„çº½å¸¦ï¼Œå®ƒçš„ä¸»è¦ä½œç”¨æ˜¯ç”¨æ¥å­˜æ”¾ Watcher è§‚å¯Ÿè€…å¯¹è±¡:</p>

<p><img src="https://user-gold-cdn.xitu.io/2018/1/5/160c4572fdd738f2?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="dep" /></p>

<pre><code class="language-JS">export default class Dep {
  static target: ? Watcher;
  id: number;
  subs: Array&lt;Watcher&gt;;
  constructor () {
    this.id = uid++
    this.subs = []
  }
  /* åœ¨ subs ä¸­æ·»åŠ ä¸€ä¸ªè§‚å¯Ÿè€…å¯¹è±¡ */
  addSub (sub: Watcher) {
    this.subs.push(sub)
  }
  /* ç§»é™¤ä¸€ä¸ªè§‚å¯Ÿè€…å¯¹è±¡ */
  removeSub (sub: Watcher) {
    remove(this.subs, sub)
  }
  /* ä¾èµ–æ”¶é›†ï¼Œå½“å­˜åœ¨ Dep.target çš„æ—¶å€™æ·»åŠ è§‚å¯Ÿè€…å¯¹è±¡ */
  depend () {
    if (Dep.target) {
      Dep.target.addDep(this)
    }
  }
  /* é€šçŸ¥æ‰€æœ‰è®¢é˜…è€…æ›´æ–°æ•°æ® */
  notify () {
    // stabilize the subscriber list first
    const subs = this.subs.slice()
    for (let i = 0, l = subs.length; i &lt; l; i++) {
      subs[i].update() // æ›´æ–°æ•°æ®
    }
  }
}
</code></pre>

<h3 id="watcher-è§‚å¯Ÿè€…å¯¹è±¡">Watcher è§‚å¯Ÿè€…å¯¹è±¡</h3>

<p><strong>Watcher</strong> æ˜¯ä¸€ä¸ªè§‚å¯Ÿè€…å¯¹è±¡ã€‚ä¾èµ–æ”¶é›†ä»¥å Watcher å¯¹è±¡ä¼šè¢«ä¿å­˜åœ¨ Dep çš„ subs ä¸­ï¼Œæ•°æ®å˜åŠ¨çš„æ—¶å€™ Dep ä¼šé€šçŸ¥ Watcher å®ä¾‹ï¼Œç„¶åç”± Watcher å®ä¾‹å›è°ƒè¿›è¡Œè§†å›¾çš„æ›´æ–°</p>

<pre><code class="language-JS">export default class Watcher {
  constructor (
    vm: Component,
    expOrFn: string | Function,
    cb: Function,
    options?: Object
  ) {
    this.vm = vm
    /*_ watchers å­˜æ”¾è®¢é˜…è€…å®ä¾‹ */
    vm._watchers.push(this)
    ...
    // parse expression for getter
    if (typeof expOrFn === 'function') {
      // å¦‚æœæ˜¯å‡½æ•°ï¼Œç›¸å½“äºæŒ‡å®šäº†å½“å‰è®¢é˜…è€…è·å–æ•°æ®çš„æ–¹æ³•ï¼Œæ¯æ¬¡è®¢é˜…è€…é€šè¿‡è¿™ä¸ªæ–¹æ³•è·å–æ•°æ®ç„¶åä¸ä¹‹å‰çš„å€¼è¿›è¡Œå¯¹æ¯”
      this.getter = expOrFn
    } else {
      this.getter = parsePath(expOrFn) // å¦åˆ™çš„è¯å°†è¡¨è¾¾å¼è§£æä¸ºå¯æ‰§è¡Œçš„å‡½æ•°
      ......
    }
    this.value = this.lazy
      ? undefined
      : this.get()   // å¦‚æœ lazy ä¸ä¸º trueï¼Œåˆ™æ‰§è¡Œ get å‡½æ•°è¿›è¡Œä¾èµ–æ”¶é›†
  }
   /* è·å¾— getter çš„å€¼å¹¶ä¸”é‡æ–°è¿›è¡Œä¾èµ–æ”¶é›† */
  get () {
    /* å°†è‡ªèº« watcher è§‚å¯Ÿè€…å®ä¾‹è®¾ç½®ç»™ Dep.targetï¼Œç”¨ä»¥ä¾èµ–æ”¶é›†ã€‚*/
    pushTarget(this)
    let value
    const vm = this.vm
    /* æ‰§è¡Œäº† getter æ“ä½œï¼Œçœ‹ä¼¼æ‰§è¡Œäº†æ¸²æŸ“æ“ä½œï¼Œå…¶å®æ˜¯æ‰§è¡Œäº†ä¾èµ–æ”¶é›†ã€‚
      åœ¨å°† Dep.target è®¾ç½®ä¸ºè‡ªç”Ÿè§‚å¯Ÿè€…å®ä¾‹ä»¥åï¼Œæ‰§è¡Œ getter æ“ä½œã€‚
      è­¬å¦‚è¯´ç°åœ¨çš„çš„ data ä¸­å¯èƒ½æœ‰ aã€bã€c ä¸‰ä¸ªæ•°æ®ï¼Œgetter æ¸²æŸ“éœ€è¦ä¾èµ– a è·Ÿ cï¼Œ
      é‚£ä¹ˆåœ¨æ‰§è¡Œ getter çš„æ—¶å€™å°±ä¼šè§¦å‘ a è·Ÿ c ä¸¤ä¸ªæ•°æ®çš„ getter å‡½æ•°ï¼Œ
      åœ¨ getter å‡½æ•°ä¸­å³å¯åˆ¤æ–­ Dep.target æ˜¯å¦å­˜åœ¨ç„¶åå®Œæˆä¾èµ–æ”¶é›†ï¼Œ
      å°†è¯¥è§‚å¯Ÿè€…å¯¹è±¡æ”¾å…¥é—­åŒ…ä¸­çš„ Dep çš„ subs ä¸­å»ã€‚*/
    if (this.user) {
      try {
        value = this.getter.call(vm, vm)
      } catch (e) {
        handleError(e, vm, `getter for watcher "${this.expression}"`)
      }
    } else {
      value = this.getter.call(vm, vm)
    }
    /* å¦‚æœå­˜åœ¨ deepï¼Œåˆ™è§¦å‘æ¯ä¸ªæ·±å±‚å¯¹è±¡çš„ä¾èµ–ï¼Œè¿½è¸ªå…¶å˜åŒ– */
    if (this.deep) {
      /* é€’å½’æ¯ä¸€ä¸ªå¯¹è±¡æˆ–è€…æ•°ç»„ï¼Œè§¦å‘å®ƒä»¬çš„ getterï¼Œä½¿å¾—å¯¹è±¡æˆ–æ•°ç»„çš„æ¯ä¸€ä¸ªæˆå‘˜éƒ½è¢«ä¾èµ–æ”¶é›†ï¼Œå½¢æˆä¸€ä¸ªâ€œæ·±ï¼ˆdeepï¼‰â€ä¾èµ–å…³ç³» */
      traverse(value)
    }
    /* å°†è§‚å¯Ÿè€…å®ä¾‹ä» target æ ˆä¸­å–å‡ºå¹¶è®¾ç½®ç»™ Dep.target */
    popTarget()
    this.cleanupDeps()
    return value
  }
  /* æ·»åŠ ä¸€ä¸ªä¾èµ–å…³ç³»åˆ° Deps é›†åˆä¸­ */
  addDep (dep: Dep) {
    const id = dep.id
    if (!this.newDepIds.has(id)) {
      this.newDepIds.add(id)
      this.newDeps.push(dep)
      if (!this.depIds.has(id)) {
        dep.addSub(this)
      }
    }
  }
   /*
      è°ƒåº¦è€…æ¥å£ï¼Œå½“ä¾èµ–å‘ç”Ÿæ”¹å˜çš„æ—¶å€™è¿›è¡Œå›è°ƒã€‚
   */
  update () {
    /* istanbul ignore else */
    if (this.lazy) {
      this.dirty = true
    } else if (this.sync) {
      /* åŒæ­¥åˆ™æ‰§è¡Œ run ç›´æ¥æ¸²æŸ“è§†å›¾ */
      this.run()
    } else {
      /* å¼‚æ­¥æ¨é€åˆ°è§‚å¯Ÿè€…é˜Ÿåˆ—ä¸­ï¼Œä¸‹ä¸€ä¸ª tick æ—¶è°ƒç”¨ */
      queueWatcher(this)
    }
  }
   /*
      è°ƒåº¦è€…å·¥ä½œæ¥å£ï¼Œå°†è¢«è°ƒåº¦è€…å›è°ƒã€‚
    */
  run () {
    if (this.active) {
      /* get æ“ä½œåœ¨è·å– value æœ¬èº«ä¹Ÿä¼šæ‰§è¡Œ getter ä»è€Œè°ƒç”¨ update æ›´æ–°è§†å›¾ */
      const value = this.get()
      if (
        value !== this.value ||
        // å³ä¾¿å€¼ç›¸åŒï¼Œæ‹¥æœ‰ Deep å±æ€§çš„è§‚å¯Ÿè€…ä»¥åŠåœ¨å¯¹è±¡ï¼æ•°ç»„ä¸Šçš„è§‚å¯Ÿè€…åº”è¯¥è¢«è§¦å‘æ›´æ–°ï¼Œå› ä¸ºå®ƒä»¬çš„å€¼å¯èƒ½å‘ç”Ÿæ”¹å˜ã€‚
        isObject(value) ||
        this.deep
      ) {
        const oldValue = this.value
        this.value = value
        /* è§¦å‘å›è°ƒ */
        if (this.user) {
          try {
            this.cb.call(this.vm, value, oldValue)
          } catch (e) {
            handleError(e, this.vm, `callback for watcher "${this.expression}"`)
          }
        } else {
          this.cb.call(this.vm, value, oldValue)
        }
      }
    }
  }
  /* æ”¶é›†è¯¥ watcher çš„æ‰€æœ‰ deps ä¾èµ– */
  depend () {
    let i = this.deps.length
    while (i--) {
      this.deps[i].depend()
    }
  }
  ...
}
</code></pre>

<p>ä¾èµ–æ”¶é›†çš„æ•´ä¸ªæµç¨‹å›¾å¦‚ä¸‹:</p>

<p><img src="http://localhost:2333/style/images/smms/vue-reactive.jpg" alt="vue-reactive.jpg" /></p>

<ul>
  <li>æ¨¡æ¿ç¼–è¯‘è¿‡ç¨‹ä¸­çš„æŒ‡ä»¤å’Œæ•°æ®ç»‘å®šã€computed å±æ€§å’Œ watch å‡½æ•°ä¸­çš„å¯¹è±¡ä¼šç”Ÿæˆ Watcher å®ä¾‹ï¼Œåœ¨æ¨¡æ¿ç¼–è¯‘çš„è¿‡ç¨‹ä¸­ï¼Œä¼šæ‰§è¡Œ Watcher å®ä¾‹çš„ expOrFnï¼ˆåˆå§‹åŒ– Watcher å®ä¾‹æ—¶ä¼ å…¥çš„å‚æ•°ï¼‰ï¼Œè¿›å…¥ watcher.js ä¸­çš„ get å‡½æ•° è®¿é—® expOrFn æ¶‰åŠçš„æ‰€æœ‰å±æ€§;</li>
  <li>è®¿é—®å±æ€§ä¹‹å‰ï¼ŒWatcher ä¼šè®¾ç½® Dep çš„é™æ€å±æ€§ Dep.target æŒ‡å‘å…¶è‡ªèº«ï¼Œç„¶åå¼€å§‹ä¾èµ–æ”¶é›†;</li>
  <li>è®¿é—®å±æ€§çš„è¿‡ç¨‹ä¸­ï¼Œå±æ€§çš„ getter å‡½æ•°ä¼šè¢«è®¿é—®;</li>
  <li>å±æ€§ getter å‡½æ•°ä¸­ä¼šåˆ¤æ–­ Dep.targetï¼ˆtarget ä¸­ä¿å­˜çš„æ˜¯ç¬¬ 2 æ­¥ä¸­è®¾ç½®çš„ Watcher å®ä¾‹ï¼‰æ˜¯å¦å­˜åœ¨ï¼Œè‹¥å­˜åœ¨åˆ™å°† getter å‡½æ•°æ‰€åœ¨çš„ Observer å®ä¾‹çš„ Dep å®ä¾‹ä¿å­˜åˆ° Watcher çš„åˆ—è¡¨ä¸­ï¼Œå¹¶åœ¨æ­¤ Dep å®ä¾‹ä¸­æ·»åŠ  Watcher ä¸ºè®¢é˜…è€…;</li>
  <li>é‡å¤ä¸Šè¿°è¿‡ç¨‹ç›´è‡³ Watcher çš„ expOrFn æ¶‰åŠçš„æ‰€æœ‰å±æ€§å‡è®¿é—®ç»“æŸï¼ˆå³ expOrFn æ•°ä¸­æ‰€æœ‰çš„æ•°æ®çš„ getter å‡½æ•°éƒ½å·²è¢«è§¦å‘ï¼‰ï¼ŒDep.target è¢«ç½®ä¸º nullï¼Œä¾èµ–æ”¶é›†å®Œæˆã€‚</li>
</ul>

<h3 id="æ€»æµç¨‹å›¾">æ€»æµç¨‹å›¾</h3>

<p><img src="http://localhost:2333/style/images/smms/vue-reactivity-full.png" alt="vue-reactivity-full.png" /></p>

<p>æ€»ç»“æ¥è¯´å°±æ˜¯ï¼š</p>

<ul>
  <li>åœ¨ç”Ÿå‘½å‘¨æœŸçš„ initState æ–¹æ³•ä¸­å°† dataã€prop ä¸­çš„æ•°æ®åŠ«æŒï¼Œé€šè¿‡ observe æ–¹æ³•ä¸ defineReactive æ–¹æ³•å°†ç›¸å…³å¯¹è±¡è½¬æ¢ä¸º Observer å¯¹è±¡;</li>
  <li>ç„¶ååœ¨ initRender æ–¹æ³•ä¸­è§£ææ¨¡æ¿ï¼Œé€šè¿‡ Watcher å¯¹è±¡ï¼ŒDep å¯¹è±¡ä¸è§‚å¯Ÿè€…æ¨¡å¼å°†æ¨¡æ¿ä¸­çš„æŒ‡ä»¤ä¸å¯¹åº”çš„æ•°æ®å»ºç«‹ä¾èµ–å…³ç³»ï¼Œåœ¨è¿™ä¸ªä¾èµ–æ”¶é›†çš„è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨äº†å…¨å±€å¯¹è±¡ Dep.target;</li>
  <li>æœ€åï¼Œå½“æ•°æ®å‘ç”Ÿæ”¹å˜æ—¶ï¼Œè§¦å‘ Object.defineProperty æ–¹æ³•ä¸­çš„ dep.notify æ–¹æ³•ï¼Œéå†è¯¥æ•°æ®çš„ä¾èµ–åˆ—è¡¨ï¼Œæ‰§è¡Œå…¶ update æ–¹æ³•é€šçŸ¥ Watcher è¿›è¡Œè§†å›¾æ›´æ–°ã€‚</li>
</ul>

<h2 id="virtual-dom">Virtual DOM</h2>

<h3 id="compile-ç¼–è¯‘">compile ç¼–è¯‘</h3>

<p><strong>compile</strong> ç¼–è¯‘å¯ä»¥åˆ†æˆ <strong>parse</strong>ã€<strong>optimize</strong> ä¸ <strong>generate</strong> ä¸‰ä¸ªé˜¶æ®µï¼Œæœ€ç»ˆéœ€è¦å¾—åˆ° <strong>render function</strong>ã€‚è¿™éƒ¨åˆ†è¯·<a href="https://juejin.im/book/5a36661851882538e2259c0f/section/5a3bb1745188254b8b355428">å‚è€ƒæ˜é‡‘å°å†Œ</a>:</p>

<ul>
  <li><strong>parse</strong> - ä¼šç”¨æ­£åˆ™ç­‰æ–¹å¼å°† template æ¨¡æ¿ä¸­è¿›è¡Œå­—ç¬¦ä¸²è§£æï¼Œå¾—åˆ°æŒ‡ä»¤ã€classã€style ç­‰æ•°æ®ï¼Œå½¢æˆ <a href="https://zh.wikipedia.org/wiki/%E6%8A%BD%E8%B1%A1%E8%AA%9E%E6%B3%95%E6%A8%B9">AST æŠ½è±¡è¯­æ³•æ ‘</a></li>
  <li><strong>optimize</strong> - ä¸ºé™æ€çš„èŠ‚ç‚¹åšä¸Šä¸€äº›ã€Œæ ‡è®°ã€ï¼Œåœ¨ patch çš„æ—¶å€™å¯ä»¥ç›´æ¥è·³è¿‡è¿™äº›è¢«æ ‡è®°çš„èŠ‚ç‚¹çš„æ¯”å¯¹ï¼Œä»è€Œè¾¾åˆ°ã€Œä¼˜åŒ–ã€çš„ç›®çš„</li>
  <li><strong>generate</strong> - ä¼šå°† AST è½¬åŒ–æˆ render funtion å­—ç¬¦ä¸²</li>
</ul>

<h3 id="render-function">render function</h3>

<p><strong>render function</strong> ä¼šè¢«è½¬åŒ–æˆ <strong>VNode</strong> èŠ‚ç‚¹ã€‚<strong>Virtual DOM</strong> å…¶å®å°±æ˜¯ä¸€æ£µä»¥ JavaScript å¯¹è±¡(VNode èŠ‚ç‚¹)ä½œä¸ºåŸºç¡€çš„æ ‘ï¼Œç”¨å¯¹è±¡å±æ€§æ¥æè¿°èŠ‚ç‚¹ï¼Œå®é™…ä¸Šå®ƒåªæ˜¯ä¸€å±‚å¯¹çœŸå® DOM çš„æŠ½è±¡ã€‚æœ€ç»ˆå¯ä»¥é€šè¿‡ä¸€ç³»åˆ—æ“ä½œä½¿è¿™æ£µæ ‘æ˜ å°„åˆ°çœŸå®ç¯å¢ƒä¸Šã€‚ç”±äº Virtual DOM æ˜¯ä»¥ JavaScript å¯¹è±¡ä¸ºåŸºç¡€è€Œä¸ä¾èµ–çœŸå®å¹³å°ç¯å¢ƒï¼Œæ‰€ä»¥ä½¿å®ƒå…·æœ‰äº†è·¨å¹³å°çš„èƒ½åŠ›ï¼Œæ¯”å¦‚è¯´æµè§ˆå™¨å¹³å°ã€Weexã€Node ç­‰ã€‚</p>

<p>åœ¨ä¿®æ”¹æ•°æ®è§¦å‘ setter åï¼Œä¼šè§¦å‘å¯¹åº” Dep ä¸­çš„ Watcher å¯¹è±¡ã€‚Watcher å¯¹è±¡ä¼šè°ƒç”¨å¯¹åº”çš„ update æ¥ä¿®æ”¹è§†å›¾ã€‚æœ€ç»ˆæ˜¯å°†æ–°äº§ç”Ÿçš„ VNode èŠ‚ç‚¹ä¸è€ VNode è¿›è¡Œä¸€ä¸ª <strong>patch</strong> çš„è¿‡ç¨‹ï¼Œæ¯”å¯¹å¾—å‡ºã€Œå·®å¼‚ã€ï¼Œæœ€ç»ˆå°†è¿™äº›ã€Œå·®å¼‚ã€æ›´æ–°åˆ°è§†å›¾ä¸Šã€‚patch çš„æ ¸å¿ƒç®—æ³•ä¸º <strong>diff</strong>:</p>

<p><img src="https://user-gold-cdn.xitu.io/2017/12/28/1609be691ed64525?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="diff-before" /></p>

<p>diff ç®—æ³•æ˜¯é€šè¿‡åŒå±‚çš„æ ‘èŠ‚ç‚¹è¿›è¡Œæ¯”è¾ƒè€Œéå¯¹æ ‘è¿›è¡Œé€å±‚æœç´¢éå†çš„æ–¹å¼ï¼Œæ‰€ä»¥æ—¶é—´å¤æ‚åº¦åªæœ‰ O(n)ï¼Œæ˜¯ä¸€ç§ç›¸å½“é«˜æ•ˆçš„ç®—æ³•:</p>

<p><img src="https://user-gold-cdn.xitu.io/2017/12/28/1609be700a80c98a?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="diff-after" /></p>

<p>å› æ­¤å¼‚æ­¥æ›´æ–°çš„æ­¥éª¤å¯ä»¥ç®€åŒ–ä¸º <code class="highlighter-rouge">setter -&gt; Dep -&gt; Watcher -&gt; patch -&gt; è§†å›¾</code></p>

<p><img src="https://user-gold-cdn.xitu.io/2017/12/19/1606e7eaa2a664e8?imageView2/0/w/1280/h/960/format/webp/ignore-error/1" alt="virtual-dom" /></p>

<h2 id="å‚è€ƒé“¾æ¥">å‚è€ƒé“¾æ¥</h2>

<ol>
  <li><a href="https://cn.vuejs.org/">Vue ä¸­æ–‡å®˜ç½‘</a></li>
  <li><a href="https://zhouweicsu.github.io/blog/2017/03/07/vue-2-0-reactivity/">Vue2.0 æºç é˜…è¯»ï¼šå“åº”å¼åŸç†</a> By zhouweicsu</li>
  <li><a href="http://jungahuang.com/2018/02/07/About-responsive-of-Vue/#more">æ·±å…¥ç†è§£ Vue å“åº”å¼åŸç†</a> By Junga Huang</li>
  <li><a href="https://juejin.im/book/5a36661851882538e2259c0f/section/5a37bbb35188257d167a4d64">æ˜é‡‘å°å†Œ - å‰–æ Vue.js å†…éƒ¨è¿è¡Œæœºåˆ¶</a></li>
</ol>
 
<div id="gitalk-container"></div>
<script>
    var gitalk = new Gitalk({
      enable: true,
      clientID: '020f142489f80c92b097',
      clientSecret: '1fa083372b44031cf1b8249251515c4e3d54c69d',
      repo: 'tate-young.github.io',
      owner: 'Tate-Young',
      admin: ['Tate-Young'],
      id: location.pathname,      // Ensure uniqueness and length less than 50
      distractionFreeMode: false  // Facebook-like distraction free mode
    })

    gitalk.render('gitalk-container')
</script>
<!-- disqus -->
<!-- <div id="disqus_thread"></div>
<script>
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */

    var disqus_config = function () {
        this.page.url = 'https://tate-young.github.io/2018/07/20/vue-reactivity-in-depth.html';
        this.page.identifier = '/2018/07/20/vue-reactivity-in-depth';
        this.page.title = 'Vue æ·±å…¥å“åº”å¼åŸç†';
    };

    (function () { // REQUIRED CONFIGURATION VARIABLE: EDIT THE SHORTNAME BELOW
        var d = document,
            s = d.createElement('script');

        s.src = '//tate.disqus.com/embed.js'; // IMPORTANT: Replace EXAMPLE with your forum shortname!

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the
    <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript> -->


            <!-- <p class="post-info">
			æœ¬æ–‡ç”± <a href="/">liberxue</a> åˆ›ä½œï¼Œé‡‡ç”¨ <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="external nofollow">çŸ¥è¯†å…±äº«ç½²å4.0</a> å›½é™…è®¸å¯åè®®è¿›è¡Œè®¸å¯<br>æœ¬ç«™æ–‡ç« é™¤æ³¨æ˜è½¬è½½/å‡ºå¤„å¤–ï¼Œå‡ä¸ºæœ¬ç«™åŸåˆ›æˆ–ç¿»è¯‘ï¼Œè½¬è½½å‰è¯·åŠ¡å¿…ç½²å<br>æœ€åç¼–è¾‘æ—¶é—´ä¸º:2018-07-20 18:25:00</p> -->
        </div>
    </article>

    <!-- <div class="related-post-lists">
	<div class="post-lists">
		<div class="post-lists-body">
					<div class="post-list-item">
				<div class="post-list-item-container">
					<div class="item-label">
						<div class="item-title"><a href="induction.html">å½’çº³çš„éšæƒ³</a></div>
						<div class="item-meta clearfix">
														<div class="item-meta-ico bg-ico-image" style="background: url('../usr/themes/pinghsu/images/bg-ico.png') no-repeat;background-size: 40px auto;"></div>
	                        							<div class="item-meta-cat"><a href="../category/thoughts/index.html">Thoughts</a></div>
						</div>
					</div>
				</div>
			</div>
				</div>
	</div>
</div> -->

    <!-- <footer class="footer bg-white">
	<div class="footer-social">
		<div class="footer-container clearfix">
			<div class="social-list">
	 <a class="social segmentfault" target="blank" href="https://segmentfault.com/u/liberxue" title="è®¿é—® LiberXue_Twitter" data-hover="Segmentfault">Segmentfault</a>
    <a class="social github" target="blank" href="https://github.com/liberxue" title="è®¿é—® LiberXue_Twitter" data-hover="GitHub">GitHub</a>
    <a class="social twitter" target="blank" href="http://twitter.com/liberxue" title="è®¿é—® LiberXue_Twitter" data-hover="Twitter">Twitter</a>
     <a class="social stackoverflow" target="blank" href="https://stackoverflow.com/users/6902190/liberxue" title="è®¿é—® LiberXue_stackoverflow" data-hover="StackOverflow">StackOverflow</a>
          <a class="social oschina" target="blank" href="https://my.oschina.net/bolanzw" title="è®¿é—® LiberXue_Oschina" data-hover="Oschina">Oschina</a>
     <a class="social rss" target="blank" href="/feed.xml"title="è®¿é—® LiberXue_RSS" data-hover="RSS">RSS</a>
	</div>
		</div>
	</div>
	<div class="footer-meta">
        <div class="footer-container">
            <div class="meta-item meta-copyright">
                <div class="meta-copyright-info">
                    <a href="/" class="info-logo">
                         <img src="http://localhost:2333/style/images/logo-liberxue.png"   title="è®¿é—® LiberXue_blog" data-hover="LiberXue_blog" alt="LiberXue_blog" /> </a>
                    <div class="info-text">
                        <p>Theme is <a href="http://www.liberxue.com/2017/08/03/Jekyllthemes.html" title="è®¿é—® Jekyll liberxueä¸»é¢˜"  data-hover="Jekyll liberxue"target="_blank">Jekyll liberxue</a> by <a href="http://www.liberxue.com/about" target="_blank">liberxue</a></p>
                        <p>Powered by <a href="http://localhost:2333/tags/#Jekyll" title="Jekyll" data-hover="Jekyll" target="_blank" rel="nofollow">Jekyll</a></p>
                        <p>&copy; 2017 <a href="/feed.xml"  title="è®¿é—® liberxue blog RSS" data-hover="liberxue blog RSS">liberxue blog RSS</a></p>
                        <p>æ€»è®¡æ–‡ç« ï¼šç¯‡</p>
                      <p>æœ¬blogå·²å¼€æºç‚¹å‡»Fork</p><iframe src="http://ghbtns.com/github-btn.html?user=liberxue&repo=liberxue.github.io&type=fork&count=true" allowtransparency="true" frameborder="0" scrolling="0" width="95" height="20"></iframe>
                    </div>
                </div>
            </div>
            <div class="meta-item meta-posts">
                <h3 class="meta-title">ç½®é¡¶æ–‡ç« </h3>
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
            </div>
            <div class="meta-item meta-comments">
                <h3 class="meta-title">æœ€æ–°æ–‡ç« </h3>
  
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
</div>
		</div>
    </div>
</footer> -->
<script src="//cdn.bootcss.com/jquery/2.2.2/jquery.min.js"></script>
<script src="//cdn.bootcss.com/bootstrap-3-typeahead/4.0.2/bootstrap3-typeahead.js"></script>
<script async src="/search/js/520.js"></script>
<script async src="/search/js/gtag.js"></script>
<!-- <script async src="/search/live2d/autoload.js"></script> -->
<!-- <script src="/search/js/canvas.js"></script> -->

<script>
    $(function () {
        setTimeout(function () {
            $('code').removeClass('hljs');
            $('code').removeClass('language');
        }, 90);
    });
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    <!--liberxueconnnet-menu-->
    <div id="directory-content" class="directory-content">
        <div id="directory"></div>
    </div>
    <!--liberxueconnnet-menu-->
    <script>
      const directoryContainer = document.getElementById('directory')
      const postTitle = document.getElementsByClassName('post-title')[0]
      var postDirectoryBuild = function () {
        var postChildren = function children(childNodes, reg) {
          var result = [],
              isReg = typeof reg === 'object',
              isStr = typeof reg === 'string',
              node, i, len;
          for (i = 0, len = childNodes.length; i < len; i++) {
            node = childNodes[i];
            if ((node.nodeType === 1 || node.nodeType === 9) &&
              (!reg ||
                  isReg && reg.test(node.tagName.toLowerCase()) ||
                  isStr && node.tagName.toLowerCase() === reg)) {
                result.push(node);
              }
            }
            return result;
          },
          createPostDirectory = function (article, directory, isDirNum) {
            var contentArr = [],
                titleId = [],
                levelArr, root, level,
                currentList, list, li, link, i, len;
            levelArr = (function (article, contentArr, titleId) {
                  var titleElem = postChildren(article.childNodes, /^h\d$/),
                      levelArr = [],
                      lastNum = 1,
                      lastRevNum = 1,
                      count = 0,
                      guid = 1,
                      id = 'directory' + (Math.random() + '').replace(/\D/, ''),
                      lastRevNum, num, elem;
                  while (titleElem.length) {
                      elem = titleElem.shift();
                      contentArr.push(elem.innerHTML);
                      num = +elem.tagName.match(/\d/)[0];
                      if (num > lastNum) {
                          levelArr.push(1);
                          lastRevNum += 1;
                      } else if (num === lastRevNum ||
                          num > lastRevNum && num <= lastNum) {
                          levelArr.push(0);
                          lastRevNum = lastRevNum;
                      } else if (num < lastRevNum) {
                          levelArr.push(num - lastRevNum);
                          lastRevNum = num;
                      }
                      count += levelArr[levelArr.length - 1];
                      lastNum = num;
                      elem.id = elem.id || (id + guid++);
                      titleId.push(elem.id);
                  }
                  if (count !== 0 && levelArr[0] === 1) levelArr[0] = 0;

                  return levelArr;
              })(article, contentArr, titleId);
              currentList = root = document.createElement('ul');
              dirNum = [0];
              for (i = 0, len = levelArr.length; i < len; i++) {
                  level = levelArr[i];
                  if (level === 1) {
                      list = document.createElement('ul');
                      if (!currentList.lastElementChild) {
                          currentList.appendChild(document.createElement('li'));
                      }
                      currentList.lastElementChild.appendChild(list);
                      currentList = list;
                      dirNum.push(0);
                  } else if (level < 0) {
                      level *= 2;
                      while (level++) {
                          if (level % 2) dirNum.pop();
                          currentList = currentList.parentNode;
                      }
                  }
                  dirNum[dirNum.length - 1]++;
                  li = document.createElement('li');
                  link = document.createElement('a');
                  link.name = '#' + titleId[i];
                  link.href = 'Javascript:;'
                  link.className = "post-aside-anchor"
                  link.title = 'è®¿é—®' + titleId[i];
                  link.innerHTML = !isDirNum ? contentArr[i] :
                      dirNum.join('.') + ' ' + contentArr[i];
                  li.appendChild(link);
                  currentList.appendChild(li);
              }
            directory.appendChild(root);
          };
        createPostDirectory(document.getElementById('post-content'), directoryContainer, true);
      };
      postDirectoryBuild();
    </script>
    <script>
      // gtag('config', GA_TRACKING_ID, {
      //   'page_title' : 'Blog',
      //   'page_path': window.location.pathname,
      //   'post_title': 'watttsdfasdf',
      // });

    </script>
    <script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
    <script>
        lang = hljs.initHighlightingOnLoad();
    </script>
</body>

</html>
