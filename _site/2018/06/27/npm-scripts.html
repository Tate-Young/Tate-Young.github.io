
<!DOCTYPE>
<html lang="zh-cn" data-scribe-reduced-action-queue="true">

<head>
    <meta content='NPM Scripts - Tate & Snow' name='title' />
    <meta content='NPM Scripts - Tate & Snow' name='og:title' />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
    <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
    <title>NPM Scripts - Tate & Snow</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>NPM Scripts - Tate & Snow</title>
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="NPM Scripts - Tate & Snow">
<meta name="twitter:keywords" content="NPM Scripts - Tate & Snow" property='og:description' />
<meta property="og:type" content="article">
<meta property="og:title" content="NPM Scripts - Tate & Snow">
<meta name="og:keywords" content="NPM Scripts - Tate & Snow|NPM ScriptsNPM Scriptspackage.jsonpackage.json 文件定义了项目所需要的依赖模块和配置信息。可以通过npm init命令来创建 package.json 文件，使用参数 -f 可跳过此问答环..."
  property='og:description' />
<link rel="icon" type="image/png" href="http://localhost:4000/style/favicons/favicon.ico" />
<link href="http://localhost:4000/style/favicons/favicon.ico" rel="shortcut icon" type="image/png">
<link rel="canonical" href="http://localhost:4000/">
<link rel="alternate" type="application/rss+xml" title="Liberxue" href="http://localhost:4000/feed.xml">
<meta charset="UTF-8">
<link rel="manifest" href="/manifest.json">
<link rel="shortcut icon" href="http://localhost:4000/style/favicons/favicon.ico" type="image/x-icon">
<meta name="keywords" content="NPM ScriptsNPM Scriptspackage.jsonpackage.json 文件定义了项目所需要的依赖模块和配置信息。可以通过npm init命令来创建 package.json 文件，使用参数 -f 可跳过此问答环..." property='og:description'
/>
<meta name="description" content="Tate & Snow's Github blog" />
<link href="https://cdn.bootcss.com/highlight.js/9.10.0/styles/xcode.min.css" rel="stylesheet">
<link href="http://localhost:4000/style/theme.css" rel="stylesheet"> 
<meta content='http://localhost:4000/2018/06/27/npm-scripts.html' property='og:url' />
<meta content="http://localhost:4000/2018/06/27/npm-scripts.html|NPM ScriptsNPM Scriptspackage.jsonpackage.json 文件定义了项目所需要的依赖模块和配置信息。可以通过npm init命令来创建 package.json 文件，使用参数 -f 可跳过此问答环..." property='og:description'
/>
<meta content="article" property="og:type" /> 

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-136311746-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  window.GA_TRACKING_ID = 'UA-136311746-1'
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('set', {
    'country': 'US',
    'currency': 'USD',
    'description': 'fuck',
  });
  gtag('config', GA_TRACKING_ID, {
    'custom_map': {
      'dimension1': 'post_title',
    },
    'post_title': 'test',
  });
</script>
<meta content="" property="fb:app_id" />
<script>
  (function (d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s);
    js.id = id;
    js.src = "//connect.facebook.net/en_GB/all.js#xfbml=1&appId=";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
</script>

</head>

<body class="" gtools_scp_screen_capture_injected="true">
    <header id="header" class="header bg-white">
        <div class="navbar-container">
            <a href="Javascript:;" onclick="onClickLogo()" title="访问 Tate & Snow" class="navbar-logo">
                <img src="https://i.loli.net/2018/03/13/5aa74f5b4c2c7.png" alt="Tate & Snow"> </a>
            <!-- <a href="/?tate" title="访问 Tate & Snow" class="navbar-logo">Tate & Snow</a>   -->
            <div class="navbar-menu">
                
                <a href="Javascript:;" onclick="onClickMenu('首页', '/')" title="访问 首页" data-hover="首页">首页</a>
                
                <a href="Javascript:;" onclick="onClickMenu('前端', '/front')" title="访问 前端" data-hover="前端">前端</a>
                
                <a href="Javascript:;" onclick="onClickMenu('框架', '/tool')" title="访问 框架" data-hover="框架">框架</a>
                
                <a href="Javascript:;" onclick="onClickMenu('后端', '/back')" title="访问 后端" data-hover="后端">后端</a>
                
                <a href="Javascript:;" onclick="onClickMenu('标签', '/tags')" title="访问 标签" data-hover="标签">标签</a>
                
                <a href="Javascript:;" onclick="onClickMenu('关于', '/README')" title="访问 关于" data-hover="关于">关于</a>
                
            </div>
            <!-- <div class="navbar-menu">
                
                <a href="http://localhost:4000/">首页</a>
                
                <a href="http://localhost:4000/front">前端</a>
                
                <a href="http://localhost:4000/tool">框架</a>
                
                <a href="http://localhost:4000/back">后端</a>
                
                <a href="http://localhost:4000/tags">标签</a>
                
                <a href="http://localhost:4000/README">关于</a>
                
            </div> -->
            <div class="navbar-search" onclick="onClickSearch()">
                <span class="icon-search"></span>
                <form id="cb-search-btn" role="search">
                    <span class="search-box">
                        <input type="text" class="input" id="cb-search-content" required="true" placeholder="标题 标签..." maxlength="30" autocomplete="off">
                    </span>
                </form>
            </div>
            <div class="navbar-mobile-menu" onclick="">
                <span class="icon-menu cross">
                    <span class="middle"></span>
                </span>
                <ul>
                    
                    <li>
                        <a href="Javascript:;" onclick="onClickMenu('首页', 'http://localhost:4000/')">首页</a>
                    </li>
                    
                    <li>
                        <a href="Javascript:;" onclick="onClickMenu('前端', 'http://localhost:4000/front')">前端</a>
                    </li>
                    
                    <li>
                        <a href="Javascript:;" onclick="onClickMenu('框架', 'http://localhost:4000/tool')">框架</a>
                    </li>
                    
                    <li>
                        <a href="Javascript:;" onclick="onClickMenu('后端', 'http://localhost:4000/back')">后端</a>
                    </li>
                    
                    <li>
                        <a href="Javascript:;" onclick="onClickMenu('标签', 'http://localhost:4000/tags')">标签</a>
                    </li>
                    
                    <li>
                        <a href="Javascript:;" onclick="onClickMenu('关于', 'http://localhost:4000/README')">关于</a>
                    </li>
                    
                </ul>
            </div>
        </div>
    </header>
    <a href="#header" class="back-to-top" onclick="onClickTop('NPM Scripts')">⤴Top⤴</a>
    <div class="post-header-thumb bg-white}">
        <div class="post-header-thumb-op"></div>
        <div class="post-header-thumb">
            <div class="post-header-thumb-container">
                <h1 class="post-title" itemprop="name headline">
                    NPM Scripts</h1>
                <div class="post-data">
                    <time datetime="2018-06-27 17:57:00" itemprop="datePublished">
                      发布时间：2018-06-27 17:57:00
                      &nbsp;&nbsp;&nbsp;
                      
                        修改时间：2019-06-14 14:01:00
                      
                    </time>
                    <a onclick="onClickCategory('前端')" href="Javascript:;" title="访问 前端" data-hover="博客分类: 前端">博客分类: 前端</a>
                    <!-- <a href="#read"> 阅读次数: comments</a>  -->
                </div>
                <div class="post-tags">
                       
                    <a href="Javascript:;" onclick="onClickTag('NPM')" title="访问NPM" data-hover="NPM">
                        NPM
                        <span>(1)</span>
                        
                    </a>
                       
                </div>
            </div>
        </div>
    </div>
    <article class="main-content post-page" itemscope itemtype="http://schema.org/Article">
        <div class="post-header">
            <h1 class="post-title" itemprop="name headline">
                NPM Scripts</h1>
            <div class="post-data">
                <time datetime="2018-06-27 17:57:00" itemprop="datePublished">2018-06-27 17:57:00</time>
            </div>
        </div>
        <div id="post-content" class="post-content" itemprop="articleBody">
            <p class="post-tags">
                   
                <a href="Javascript:;" onclick="onClickTag('NPM')" title="访问NPM" data-hover="NPM">
                    NPM
                    <span>(1)</span>
                    </a>
                   
            </p>
            <h1 id="npm-scripts">NPM Scripts</h1>

<h2 id="npm-scripts-1">NPM Scripts</h2>

<h3 id="packagejson">package.json</h3>

<p><strong>package.json</strong> 文件定义了项目所需要的依赖模块和配置信息。可以通过<code>npm init</code>命令来创建 package.json 文件，使用参数 <strong>-f</strong> 可跳过此问答环节:</p>

<pre><code class="language-SHELL">npm init

# 跳过问答环节，快速创建
npm init -f
</code></pre>

<p>当然也可以在初始化前通过<code>npm config set</code>命令去修改默认配置，之后通过初始化时都会套用此配置项:</p>

<pre><code class="language-SHELL">npm config set init.author.name "tate"
npm config set init.author.email "smd.tate@gmail.com"
npm config set init.license "MIT"
</code></pre>

<p>创建的 package.json 文件大致如下:</p>

<pre><code class="language-JSON">{
  "name": "npm_scripts",
  "version": "1.0.0",
  "description": "tate",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" &amp;&amp; exit 1"
  },
  "author": "tate &lt;smd.tate@gmail.com&gt;",
  "license": "MIT"
}
</code></pre>

<h3 id="脚本命令-scripts">脚本命令 scripts</h3>

<p>package.json 文件里的 scripts 属性下可以自定义执行命令，可以通过命令<code>npm run</code>进行查看:</p>

<pre><code class="language-JSON">"scripts": {
  "call:tate": "echo tate",
  "call:snow": "echo snow",
}
</code></pre>

<p>可以通过符号 <strong>&amp;&amp;</strong> 和 <strong>&amp;</strong> 实现串行和并行脚本:</p>

<pre><code class="language-JSON">// 串行脚本 &amp;&amp;
"test": "npm run call:tate &amp;&amp; npm run call:snow &amp;&amp; ..."

// 并行脚本 &amp;
"test": "npm run call:tate &amp; npm run call:snow &amp; ..."
</code></pre>

<p>运行的脚本比较多的话可以采用 <strong><a href="https://www.npmjs.com/package/npm-run-all">npm-run-all</a></strong> 实现更轻量和简洁的多命令运行:</p>

<pre><code class="language-JSON">// 串行脚本
"test": "npm-run-all call:tate call:snow ..."
// 优化
"test": "npm-run-all call:*"

// 并行脚本 --parallel
"test": "npm-run-all call:* --parallel"
</code></pre>

<h3 id="传递参数-">传递参数 –</h3>

<p>“<strong>–</strong>” 分隔符用来给实际运行的指令传递额外的参数，举个栗子 🌰:</p>

<pre><code class="language-JSON">// 假设要传入一个 watch 参数
"call:tate": "echo tate",
"call:tate:watch": "echo tate --watch",

// 优化。通过 -- 分隔符传参数
// 实际执行的即是 echo tate --watch
"call:tate:watch": "npm run call:tate -- --watch",
</code></pre>

<h3 id="钩子-hooks">钩子 hooks</h3>

<p>内置的钩子可分为 <strong>pre</strong> 和 <strong>post</strong> 钩子脚本，如下:</p>

<pre><code class="language-JSON">"test": "echo tate",
"pretest": "echo pre-tate",
"posttest": "echo post-tate"
</code></pre>

<p>当执行命令<code>npm test</code>时，实际执行了 “pretest ==&gt; test ==&gt; posttest”。自定义命令也适用。配合 git hooks 可以在提交代码前后进行一些校验输出，这里推荐使用 <a href="https://www.npmjs.com/package/husky">husky</a>。</p>

<pre><code class="language-JSON">"precommit": "npm test",
"prepush": "npm test"
</code></pre>

<p>在执行<code>git commit</code>命令时，precommit 钩子会自动生效。</p>

<h3 id="变量-npm_package">变量 $npm_package</h3>

<p>通过命令<code>npm run env</code>即可查看所有变量列表:</p>

<pre><code class="language-SHELL">npm run env | grep npm_package | sort
</code></pre>

<p>要想在 scripts 内使用变量，不同环境下有两种访问方式，比如访问项目名称 name:</p>

<pre><code class="language-JSON">// The following only works on Mac OS X/Linux (bash)
"bash-script": "echo Hello $npm_package_name",
// The following only works on a Windows machine
"win-script": "echo Hello %npm_package_name%"
</code></pre>

<p>跨平台使用的话可以使用 <a href="https://www.npmjs.com/package/cross-var">cross-var</a> 或更轻量的 cross-var-no-babel:</p>

<pre><code class="language-JSON">// 单命令写法
"script": "cross-var echo Hello $npm_package_name"
// 多命令写法
"build:css": "cross-var \"node-sass src/index.scss | postcss -c .postcssrc.json | cssmin &gt; public/$npm_package_version/index.min.css\"",
</code></pre>

<h3 id="跨平台兼容">跨平台兼容</h3>

<p>除了上述的变量，还有文件系统的操作也需要考虑跨平台兼容，比如:</p>

<ul>
  <li>rimraf 或 del-cli: 用来删除文件和目录，实现类似于 <code>rm -rf</code> 的功能；</li>
  <li>cpr: 用于拷贝、复制文件和目录，实现类似于 <code>cp -r</code> 的功能；</li>
  <li>make-dir-cli: 用于创建目录，实现类似于 <code>mkdir -p</code> 的功能</li>
</ul>

<pre><code class="language-JSON">"cover:cleanup": "rm -rf coverage &amp;&amp; rm -rf .nyc_output",
// 跨平台转换
"cover:cleanup": "rimraf coverage &amp;&amp; rimraf .nyc_output"
</code></pre>

<p>设置环境变量时可以采用 <a href="https://www.npmjs.com/package/cross-env"><strong>cross-env</strong></a>:</p>

<pre><code class="language-JSON">"test": "NODE_ENV=test mocha tests/",
// 跨平台转换
"test": "cross-env NODE_ENV=test mocha tests/",
</code></pre>

<p>但是 cross-env 并不能解决大型项目中自定义环境变量的持久化问题，这里再推荐一个 <a href="https://github.com/toddbluhm/env-cmd"><strong>env-cmd</strong></a>，其缺点是不支持在命令行中自定义环境变量:</p>

<pre><code class="language-TEXT"># 文件 ./test/.env
ENV1=THANKS
ENV2=FOR ALL
ENV3=THE FISH
</code></pre>

<pre><code class="language-JSON">{
  "scripts": {
    "test": "env-cmd ./test/.env mocha -R spec"
  }
}
</code></pre>

<pre><code class="language-SHELL"># 命令行
./node_modules/.bin/env-cmd ./test/.env node index.js
</code></pre>

<p>对于更复杂的环境，我们在配置文件 <code class="highlighter-rouge">.env-cmdrc</code> 中定义环境变量:</p>

<pre><code class="language-JSON">{
  "dev": {
    "ENV1": "Thanks",
    "ENV2": "For All"
  },
  "test": {
    "ENV1": "No Thanks",
    "ENV3": "!"
  },
  "prod": {
    "ENV1": "The Fish"
  }
}
</code></pre>

<pre><code class="language-JSON">{
  "scripts": {
    "test": "env-cmd dev mocha -R spec"
  }
}
</code></pre>

<pre><code class="language-SHELL"># 命令行同时传输多个配置
./node_modules/.bin/env-cmd test,production node index.js
</code></pre>

<h3 id="版本号">版本号</h3>

<p>这里对版本号做一些解释，主要格式为 <code class="highlighter-rouge">major.minor.patch</code> ，即<code class="highlighter-rouge">主版本号.次版本号.修补版本号</code>，语义化规范可以<a href="https://semver.org/lang/zh-CN/">参考这里</a>:</p>

<ul>
  <li>波浪符号(<strong>~</strong>) - 会更新到当前 minor version(中间数字)中最新的版本，例如更新 ~1.10.0，这个库会去匹配更新到 1.10.x 的最新版本</li>
  <li>插入符号(<strong>^</strong>) - 会更新到当前 major version(首位数字)中最新的版本，例如更新 ^1.10.0，这个库会去匹配更新到 1.x.x 的最新版本</li>
  <li>不带符号 - 匹配具体版本号</li>
</ul>

<table>
  <thead>
    <tr>
      <th style="text-align: left">序号</th>
      <th style="text-align: left">描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><strong>major</strong></td>
      <td style="text-align: left">进行不向下兼容的修改时，递增主版本号</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>minor</strong></td>
      <td style="text-align: left">保持向下兼容,新增特性时，递增次版本号</td>
    </tr>
    <tr>
      <td style="text-align: left"><strong>patch</strong></td>
      <td style="text-align: left">保持向下兼容,修复问题但不影响特性时，递增修订号</td>
    </tr>
  </tbody>
</table>

<pre><code class="language-JSON">"dependencies": {
  "async": "1.2.1",
  "chokidar": "^1.0.0",
  "vizion": "latest", # 当前发布版本
  "babel": "^5.x",
  "pm2-logs": "~0.1.1",
  "ikt": "git+http://ikt.pm2.io/ikt.git#master", # Git URL 形式的依赖
  "punt": "*",
  "express": "&gt;=3.0.0",
  "connect": "1.30.2 - 2.30.2",
}
</code></pre>

<h2 id="scripty">scripty</h2>

<p>当脚本命令比较多的时候，可以通过 <a href="https://github.com/testdouble/scripty">scripty</a> 可以从将 scripts 剥离到单独文件中管理，还是看最初的栗子:</p>

<pre><code class="language-SHELL">"call:tate": "echo tate",
"call:snow": "echo snow",
</code></pre>

<p>对应根目录下创建脚本文件，注意在执行脚本时必须拥有可执行权限:</p>

<pre><code class="language-SHELL">touch scripts/call/tate.sh # 内容为 echo 'tate in scripty'
touch scripts/call/snow.sh

# 添加可执行权限
chmod -R a+x scripts/**/*.sh
</code></pre>

<p>然后将 scripts 做修改:</p>

<pre><code class="language-SHELL">"call:tate": "scripty",
"call:snow": "scripty",
</code></pre>

<p>执行命令<code>npm run call:tate</code>后，会打印如下信息:</p>

<pre><code class="language-SHELL">&gt; npm_scripts@1.0.0 call:tate /Users/tate/Desktop/lazyload-test
&gt; scripty

Executing "/Users/tate/Desktop/lazyload-test/scripts/call/tate.sh":

&gt; echo 'tate in scripty'
</code></pre>

<blockquote>
  <p>当然也可以直接通过 node 来管理，将 shell 脚本改为 node 脚本并执行，<a href="https://www.npmjs.com/package/shelljs">shelljs</a> 可以在 node 中使用 shell 命令。</p>
</blockquote>

<h2 id="构建流水线">构建流水线</h2>

<p>由于目前没有实战，关于如何构建流水线可直接<a href="https://juejin.im/book/5a1212bc51882531ea64df07/section/5a1214e3f265da432b4a6ad2">参考小册这里</a>。</p>

<h2 id="yarn--npm">yarn &amp; npm</h2>

<p><strong>包管理器</strong>: 代码通过包(package)或者称为模块(module)的方式来共享。一个包里包含所有需要共享的代码，以及描述包信息的文件，称为 package.json。和 NPM 5 的 <code>package-lock.json</code>锁文件类似，通过<code>yarn.lock</code>记录每一个依赖项的确切版本信息。</p>

<table>
  <thead>
    <tr>
      <th style="text-align: left">npm 命令</th>
      <th style="text-align: left">yarn 命令</th>
      <th style="text-align: left">功能描述</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left">npm i</td>
      <td style="text-align: left">yarn (install)</td>
      <td style="text-align: left">根据 package.json 安装所有依赖</td>
    </tr>
    <tr>
      <td style="text-align: left">npm i (–save/-S) [package]</td>
      <td style="text-align: left">yarn add [package]</td>
      <td style="text-align: left">添加依赖包至 dependencies</td>
    </tr>
    <tr>
      <td style="text-align: left">npm i [–save-dev/-D] [package]</td>
      <td style="text-align: left">yarn add [–dev/-D] [package]</td>
      <td style="text-align: left">添加依赖包至 devDependencies</td>
    </tr>
    <tr>
      <td style="text-align: left">npm i [–global/-g]</td>
      <td style="text-align: left">yarn global add</td>
      <td style="text-align: left">全局安装依赖包</td>
    </tr>
    <tr>
      <td style="text-align: left">npm uninstall [package]</td>
      <td style="text-align: left">yarn remove [package]</td>
      <td style="text-align: left">移除依赖包</td>
    </tr>
    <tr>
      <td style="text-align: left">npm update</td>
      <td style="text-align: left">yarn upgrade</td>
      <td style="text-align: left">升级依赖包</td>
    </tr>
    <tr>
      <td style="text-align: left">npm init</td>
      <td style="text-align: left">yarn init</td>
      <td style="text-align: left">互动式创建 package.json 文件</td>
    </tr>
    <tr>
      <td style="text-align: left">npm run</td>
      <td style="text-align: left">yarn run</td>
      <td style="text-align: left">运行 package.json 中预定义的脚本</td>
    </tr>
  </tbody>
</table>

<p>yarn 在 mac 的两种安装方式:</p>

<pre><code class="language-SHELL"># 通过 npm 安装
npm install --global yarn

# 通过 homebrew 安装
brew install yarn
</code></pre>

<p>更新方式:</p>

<pre><code class="language-SHELL"># 通过 Homebrew 更新
brew upgrade yarn

# 通过 yarn 更新
yarn global add yarn
</code></pre>

<p>那么再简单对比下 <code class="highlighter-rouge">npm install</code> 和 <code class="highlighter-rouge">update</code> 的区别，即对于已经安装的包，没有明确版本号的，前者会忽略:</p>

<pre><code class="language-TEXT">{
  "name":          "my-project",
  "version":       "1.0",                             // install   update
  "dependencies":  {                                  // ------------------
    "already-installed-versionless-module":  "*",     // ignores   "1.0" -&gt; "1.1"
    "already-installed-semver-module":       "^1.4.3" // ignores   "1.4.3" -&gt; "1.5.2"
    "already-installed-versioned-module":    "3.4.1"  // ignores   ignores
    "not-yet-installed-versionless-module":  "*",     // installs  installs
    "not-yet-installed-semver-module":       "^4.2.1" // installs  installs
    "not-yet-installed-versioned-module":    "2.7.8"  // installs  installs
  }
}
</code></pre>

<p>另外对于安装 <code class="highlighter-rouge">devDependecies</code> 中的依赖还有一些区别:</p>

<ul>
  <li>npm install 默认会安装，除非添加 <code class="highlighter-rouge">--production</code> 参数</li>
  <li>npm update 不会默认安装，除非添加 <code class="highlighter-rouge">--dev</code> 参数</li>
</ul>

<h2 id="npx">npx</h2>

<p><a href="https://github.com/zkat/npx"><strong>npx</strong></a> 是 <a href="https://github.com/npm/npm/releases/tag/v5.2.0">npm@5.2.0</a> 引入的一个命令，那么它是用来干嘛的呢？采用官方的说法就是:</p>

<blockquote>
  <p>npx is a tool intended to help round out the experience of using packages from the npm registry — the same way npm makes it super easy to install and manage dependencies hosted on the registry, npx makes it easy to use CLI tools and other executables hosted on the registry. It greatly simplifies a number of things that, until now, required a bit of ceremony to do with plain npm</p>
</blockquote>

<h3 id="抛弃-run-script">抛弃 run-script</h3>

<p>在这之前，npm 生态越来越倾向于将 devDependencies 安装包作为项目本地(project-local)依赖安装，而不是全局安装，这样就更加方便去管理像 gulp、webpack 这些工具的版本，比如 webpack 本地安装时就推荐局部安装:</p>

<blockquote>
  <p>对于大多数项目，我们建议本地安装。这可以在引入突破式变更(breaking change)版本时，更容易分别升级项目。通常会通过运行一个或多个 npm scripts 以在本地 node_modules 目录中查找安装的 webpack，想要运行本地安装的 webpack，你可以通过 node_modules/.bin/webpack 来访问它的 bin 版本。<a href="https://webpack.docschina.org/guides/installation/">详见这里</a> 👈</p>
</blockquote>

<p>辣么此前要这么做的话，有以下两种方法:</p>

<p>1、在 run-script 中申明，并执行 <code class="highlighter-rouge">npm build</code></p>

<pre><code class="language-JSON">"scripts": {
  "build": "webpack --config webpack.config.js"
}
</code></pre>

<p>2、直接找到项目本地的位置并执行</p>

<pre><code class="language-SHELL">./node_modules/.bin/webpack --config webpack.config.js
</code></pre>

<p>抛开以上两种写法而使用 npx 的话，只用输入下面命令即可:</p>

<pre><code class="language-SHELL">npx webpack --config webpack.config.js
</code></pre>

<h3 id="executing-one-off-commands">Executing one-off commands</h3>

<p>npx 可以让你去执行 npm 包里的二进制文件而不用去全局安装他们，因此利用 npx 还可以实现 Executing one-off commands，即执行一次性命令。npx is the last thing you need to globally install: &gt; <code class="highlighter-rouge">npm i -g npx</code> (this command also updates npx)。</p>

<p>下面举个 <code class="highlighter-rouge">create-react-app</code> 栗子，<code class="highlighter-rouge">$ npx create-react-app my-cool-new-app</code> 安装了一个临时的包并运行, 没有污染全局安装而且命令简单:</p>

<p><img src="https://cdn-images-1.medium.com/max/1600/1*OlIRsvVO5aK7ja9HmwXz_Q.gif" alt="create-react-app" /></p>

<p>下列是一些比较有趣的包，可以用 npx 尝试一番 😜，更多命令可以参考 <a href="https://github.com/junosuarez/awesome-npx">awesome-npx</a>:</p>

<pre><code class="language-TEXT">[~] npx cowsay Tate
npx: 10 安装成功，用时 1.223 秒
 _____
&lt; Tate &gt;
 -----
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||
</code></pre>

<pre><code class="language-TEXT">[~] npx happy-birthday -u snow
npx: 2 安装成功，用时 0.776 秒

🎂
お誕生日おめでとう、snow！
🎉
</code></pre>

<p>npx 还支持一些其他的参数:</p>

<p><img src="https://cdn-images-1.medium.com/max/1600/1*JqCC1irC-XxXAWiThpOUiw.gif" alt="npx-options" /></p>

<blockquote>
  <p><code class="highlighter-rouge">$ npx -p cowsay -p lolcatjs -c 'echo "$npm_package_name@$npm_package_version" | cowsay | lolcatjs'</code> installs both cowsay and lolcatjs, and gives the script access to a slew of <code class="highlighter-rouge">$npm_</code> variables from run scripts.</p>
</blockquote>

<h3 id="控制-node-版本">控制 node 版本</h3>

<p>node 版本的控制之前一般都采用 <a href="https://github.com/nvm-sh/nvm"><strong>nvm</strong></a>、<a href="https://github.com/tj/n"><strong>n</strong></a> 等版本管理工具，现在的话 npx 就能做到:</p>

<pre><code class="language-SHELL">npx -p node@&lt;version&gt;
</code></pre>

<pre><code class="language-SHELL">[~] npx node@6 -v
v6.17.1
[~] npx -p node@7 -- node -v
v7.10.1
[~] node -v
v11.14.0
</code></pre>

<p>下图是 n 的使用示例:</p>

<p><img src="https://camo.githubusercontent.com/e3c6ac1ad2a69e2e969597b69d794658cb64df88/687474703a2f2f6e696d69742e696f2f696d616765732f6e2f6e2e676966" alt="n" /></p>

<h2 id="参考链接">参考链接</h2>

<ol>
  <li><a href="https://juejin.im/book/5a1212bc51882531ea64df07/section/5a1212bcf265da431c6fe677">掘金小册 - 用 npm script 打造超溜的前端工作流</a> By 王仕军</li>
  <li><a href="http://www.ruanyifeng.com/blog/2016/10/npm_scripts.html">npm scripts 使用指南</a> By 阮一峰</li>
  <li><a href="http://www.qcyoung.com/2016/02/28/%E4%BD%BF%E7%94%A8npm%20scripts%E6%9E%84%E5%BB%BA%E9%A1%B9%E7%9B%AE/#bei-jing">使用 npm scripts 构建项目</a> By 青春样</li>
  <li><a href="https://yarnpkg.com/zh-Hans/docs">yarn 官网</a></li>
  <li><a href="https://jeffjade.com/2017/12/30/135-npm-vs-yarn-detial-memo/">Npm vs Yarn 之备忘详单</a> By 晚晴幽草轩轩主</li>
  <li><a href="https://cloud.tencent.com/developer/article/1020507">npm5 新版功能特性解析及与 yarn 评测对比</a> By 马铖</li>
  <li><a href="https://github.com/ragingDream/blog/issues/32">Package.json 中库的版本号详解</a> By ragingDream</li>
  <li><a href="https://stackoverflow.com/questions/12478679/npm-install-vs-update-whats-the-difference">npm install vs. update - what’s the difference? - stackoverflow</a></li>
  <li><a href="https://medium.com/@maybekatz/introducing-npx-an-npm-package-runner-55f7d4bd282b">Introducing npx: an npm package runner</a> By Kat Marchán</li>
</ol>
 
<div id="gitalk-container"></div>
<script>
    var gitalk = new Gitalk({
      enable: true,
      clientID: '020f142489f80c92b097',
      clientSecret: '1fa083372b44031cf1b8249251515c4e3d54c69d',
      repo: 'tate-young.github.io',
      owner: 'Tate-Young',
      admin: ['Tate-Young'],
      id: location.pathname,      // Ensure uniqueness and length less than 50
      distractionFreeMode: false  // Facebook-like distraction free mode
    })

    gitalk.render('gitalk-container')
</script>
<!-- disqus -->
<!-- <div id="disqus_thread"></div>
<script>
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */

    var disqus_config = function () {
        this.page.url = 'https://tate-young.github.io/2018/06/27/npm-scripts.html';
        this.page.identifier = '/2018/06/27/npm-scripts';
        this.page.title = 'NPM Scripts';
    };

    (function () { // REQUIRED CONFIGURATION VARIABLE: EDIT THE SHORTNAME BELOW
        var d = document,
            s = d.createElement('script');

        s.src = '//tate.disqus.com/embed.js'; // IMPORTANT: Replace EXAMPLE with your forum shortname!

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the
    <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript> -->


            <!-- <p class="post-info">
			本文由 <a href="/">liberxue</a> 创作，采用 <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="external nofollow">知识共享署名4.0</a> 国际许可协议进行许可<br>本站文章除注明转载/出处外，均为本站原创或翻译，转载前请务必署名<br>最后编辑时间为:2018-06-27 17:57:00</p> -->
        </div>
    </article>

    <!-- <div class="related-post-lists">
	<div class="post-lists">
		<div class="post-lists-body">
					<div class="post-list-item">
				<div class="post-list-item-container">
					<div class="item-label">
						<div class="item-title"><a href="induction.html">归纳的随想</a></div>
						<div class="item-meta clearfix">
														<div class="item-meta-ico bg-ico-image" style="background: url('../usr/themes/pinghsu/images/bg-ico.png') no-repeat;background-size: 40px auto;"></div>
	                        							<div class="item-meta-cat"><a href="../category/thoughts/index.html">Thoughts</a></div>
						</div>
					</div>
				</div>
			</div>
				</div>
	</div>
</div> -->

    <!-- <footer class="footer bg-white">
	<div class="footer-social">
		<div class="footer-container clearfix">
			<div class="social-list">
	 <a class="social segmentfault" target="blank" href="https://segmentfault.com/u/liberxue" title="访问 LiberXue_Twitter" data-hover="Segmentfault">Segmentfault</a>
    <a class="social github" target="blank" href="https://github.com/liberxue" title="访问 LiberXue_Twitter" data-hover="GitHub">GitHub</a>
    <a class="social twitter" target="blank" href="http://twitter.com/liberxue" title="访问 LiberXue_Twitter" data-hover="Twitter">Twitter</a>
     <a class="social stackoverflow" target="blank" href="https://stackoverflow.com/users/6902190/liberxue" title="访问 LiberXue_stackoverflow" data-hover="StackOverflow">StackOverflow</a>
          <a class="social oschina" target="blank" href="https://my.oschina.net/bolanzw" title="访问 LiberXue_Oschina" data-hover="Oschina">Oschina</a>
     <a class="social rss" target="blank" href="/feed.xml"title="访问 LiberXue_RSS" data-hover="RSS">RSS</a>
	</div>
		</div>
	</div>
	<div class="footer-meta">
        <div class="footer-container">
            <div class="meta-item meta-copyright">
                <div class="meta-copyright-info">
                    <a href="/" class="info-logo">
                         <img src="http://localhost:4000/style/images/logo-liberxue.png"   title="访问 LiberXue_blog" data-hover="LiberXue_blog" alt="LiberXue_blog" /> </a>
                    <div class="info-text">
                        <p>Theme is <a href="http://www.liberxue.com/2017/08/03/Jekyllthemes.html" title="访问 Jekyll liberxue主题"  data-hover="Jekyll liberxue"target="_blank">Jekyll liberxue</a> by <a href="http://www.liberxue.com/about" target="_blank">liberxue</a></p>
                        <p>Powered by <a href="http://localhost:4000/tags/#Jekyll" title="Jekyll" data-hover="Jekyll" target="_blank" rel="nofollow">Jekyll</a></p>
                        <p>&copy; 2017 <a href="/feed.xml"  title="访问 liberxue blog RSS" data-hover="liberxue blog RSS">liberxue blog RSS</a></p>
                        <p>总计文章：篇</p>
                      <p>本blog已开源点击Fork</p><iframe src="http://ghbtns.com/github-btn.html?user=liberxue&repo=liberxue.github.io&type=fork&count=true" allowtransparency="true" frameborder="0" scrolling="0" width="95" height="20"></iframe>
                    </div>
                </div>
            </div>
            <div class="meta-item meta-posts">
                <h3 class="meta-title">置顶文章</h3>
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
            </div>
            <div class="meta-item meta-comments">
                <h3 class="meta-title">最新文章</h3>
  
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
</div>
		</div>
    </div>
</footer> -->
<script src="//cdn.bootcss.com/jquery/2.2.2/jquery.min.js"></script>
<script src="//cdn.bootcss.com/bootstrap-3-typeahead/4.0.2/bootstrap3-typeahead.js"></script>
<script async src="/search/js/520.js"></script>
<script async src="/search/js/gtag.js"></script>
<!-- <script src="/search/js/canvas.js"></script> -->

<script>
    $(function () {
        setTimeout(function () {
            $('code').removeClass('hljs');
            $('code').removeClass('language');
        }, 90);
    });
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    <!--liberxueconnnet-menu-->
    <div id="directory-content" class="directory-content">
        <div id="directory"></div>
    </div>
    <!--liberxueconnnet-menu-->
    <script>
      const directoryContainer = document.getElementById('directory')
      const postTitle = document.getElementsByClassName('post-title')[0]
      var postDirectoryBuild = function () {
        var postChildren = function children(childNodes, reg) {
          var result = [],
              isReg = typeof reg === 'object',
              isStr = typeof reg === 'string',
              node, i, len;
          for (i = 0, len = childNodes.length; i < len; i++) {
            node = childNodes[i];
            if ((node.nodeType === 1 || node.nodeType === 9) &&
              (!reg ||
                  isReg && reg.test(node.tagName.toLowerCase()) ||
                  isStr && node.tagName.toLowerCase() === reg)) {
                result.push(node);
              }
            }
            return result;
          },
          createPostDirectory = function (article, directory, isDirNum) {
            var contentArr = [],
                titleId = [],
                levelArr, root, level,
                currentList, list, li, link, i, len;
            levelArr = (function (article, contentArr, titleId) {
                  var titleElem = postChildren(article.childNodes, /^h\d$/),
                      levelArr = [],
                      lastNum = 1,
                      lastRevNum = 1,
                      count = 0,
                      guid = 1,
                      id = 'directory' + (Math.random() + '').replace(/\D/, ''),
                      lastRevNum, num, elem;
                  while (titleElem.length) {
                      elem = titleElem.shift();
                      contentArr.push(elem.innerHTML);
                      num = +elem.tagName.match(/\d/)[0];
                      if (num > lastNum) {
                          levelArr.push(1);
                          lastRevNum += 1;
                      } else if (num === lastRevNum ||
                          num > lastRevNum && num <= lastNum) {
                          levelArr.push(0);
                          lastRevNum = lastRevNum;
                      } else if (num < lastRevNum) {
                          levelArr.push(num - lastRevNum);
                          lastRevNum = num;
                      }
                      count += levelArr[levelArr.length - 1];
                      lastNum = num;
                      elem.id = elem.id || (id + guid++);
                      titleId.push(elem.id);
                  }
                  if (count !== 0 && levelArr[0] === 1) levelArr[0] = 0;

                  return levelArr;
              })(article, contentArr, titleId);
              currentList = root = document.createElement('ul');
              dirNum = [0];
              for (i = 0, len = levelArr.length; i < len; i++) {
                  level = levelArr[i];
                  if (level === 1) {
                      list = document.createElement('ul');
                      if (!currentList.lastElementChild) {
                          currentList.appendChild(document.createElement('li'));
                      }
                      currentList.lastElementChild.appendChild(list);
                      currentList = list;
                      dirNum.push(0);
                  } else if (level < 0) {
                      level *= 2;
                      while (level++) {
                          if (level % 2) dirNum.pop();
                          currentList = currentList.parentNode;
                      }
                  }
                  dirNum[dirNum.length - 1]++;
                  li = document.createElement('li');
                  link = document.createElement('a');
                  link.name = '#' + titleId[i];
                  link.href = 'Javascript:;'
                  link.title = '访问' + titleId[i];
                  link.innerHTML = !isDirNum ? contentArr[i] :
                      dirNum.join('.') + ' ' + contentArr[i];
                  li.appendChild(link);
                  currentList.appendChild(li);
              }
            directory.appendChild(root);
          };
        createPostDirectory(document.getElementById('post-content'), directoryContainer, true);
      };
      postDirectoryBuild();
    </script>
    <script>
      // gtag('config', GA_TRACKING_ID, {
      //   'page_title' : 'Blog',
      //   'page_path': window.location.pathname,
      //   'post_title': 'watttsdfasdf',
      // });

    </script>
    <script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
    <script>
        lang = hljs.initHighlightingOnLoad();
    </script>
</body>

</html>
