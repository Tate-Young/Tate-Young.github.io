
<!DOCTYPE>
<html lang="zh-cn" data-scribe-reduced-action-queue="true">
<head>
    <meta content='TypeScript 问题收集 - Tate & Snow' name='title' />
    <meta content='TypeScript 问题收集 - Tate & Snow' name='og:title' />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
    <script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
    <title>TypeScript 问题收集 - Tate & Snow</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>TypeScript 问题收集 - Tate & Snow</title>
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="TypeScript 问题收集 - Tate & Snow">
<meta name="twitter:keywords" content="TypeScript 问题收集 - Tate & Snow" property='og:description' />
<meta property="og:type" content="article">
<meta property="og:title" content="TypeScript 问题收集 - Tate & Snow">
<meta name="og:keywords" content="TypeScript 问题收集 - Tate & Snow|TypeScript 问题收集更新点import type在以往版本中，如果我们要导入一个值或类型，直接全部导入即可，在 TS 转 JS 的时候，TS 会识别出那些导入项被当做类型使用，并将其删除。但是有时候 TS 并不能识别我们导入..."
  property='og:description' />
<link rel="icon" type="image/png" href="http://localhost:2333/style/favicons/favicon.ico" />
<link href="http://localhost:2333/style/favicons/favicon.ico" rel="shortcut icon" type="image/png">
<link rel="canonical" href="http://localhost:2333/">
<link rel="alternate" type="application/rss+xml" title="Liberxue" href="http://localhost:2333/feed.xml">
<meta charset="UTF-8">
<link rel="manifest" href="/manifest.json">
<link rel="shortcut icon" href="http://localhost:2333/style/favicons/favicon.ico" type="image/x-icon">
<meta name="keywords" content="TypeScript 问题收集更新点import type在以往版本中，如果我们要导入一个值或类型，直接全部导入即可，在 TS 转 JS 的时候，TS 会识别出那些导入项被当做类型使用，并将其删除。但是有时候 TS 并不能识别我们导入..." property='og:description'
/>
<meta name="description" content="Tate & Snow's Github blog" />
<link href="https://cdn.bootcss.com/highlight.js/9.10.0/styles/xcode.min.css" rel="stylesheet">
<link href="http://localhost:2333/style/theme.css" rel="stylesheet"> 
<meta content='http://localhost:2333/2021/01/21/ts-update.html' property='og:url' />
<meta content="http://localhost:2333/2021/01/21/ts-update.html|TypeScript 问题收集更新点import type在以往版本中，如果我们要导入一个值或类型，直接全部导入即可，在 TS 转 JS 的时候，TS 会识别出那些导入项被当做类型使用，并将其删除。但是有时候 TS 并不能识别我们导入..." property='og:description'
/>
<meta content="article" property="og:type" /> 

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-136311746-1"></script>
<!-- <script async src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script> -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css"/>
<script>
  window.dataLayer = window.dataLayer || [];
  window.GA_TRACKING_ID = 'UA-136311746-1'
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('set', {
    'country': 'US',
    'currency': 'USD',
    'description': 'fuck',
  });
  gtag('config', GA_TRACKING_ID, {
    'custom_map': {
      'dimension1': 'post_title',
    },
    'post_title': 'test',
  });
</script>
<meta content="" property="fb:app_id" />
<!-- Begin Jekyll SEO tag v2.6.1 -->
<title>TypeScript 问题收集 | Tate &amp; Snow</title>
<meta name="generator" content="Jekyll v3.8.7" />
<meta property="og:title" content="TypeScript 问题收集" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="TypeScript 问题收集" />
<meta property="og:description" content="TypeScript 问题收集" />
<link rel="canonical" href="http://localhost:2333/2021/01/21/ts-update.html" />
<meta property="og:url" content="http://localhost:2333/2021/01/21/ts-update.html" />
<meta property="og:site_name" content="Tate &amp; Snow" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-01-21T22:47:00+08:00" />
<script type="application/ld+json">
{"description":"TypeScript 问题收集","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:2333/2021/01/21/ts-update.html"},"@type":"BlogPosting","url":"http://localhost:2333/2021/01/21/ts-update.html","headline":"TypeScript 问题收集","dateModified":"2021-01-21T22:47:00+08:00","datePublished":"2021-01-21T22:47:00+08:00","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->

<script>
  (function (d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s);
    js.id = id;
    js.src = "//connect.facebook.net/en_GB/all.js#xfbml=1&appId=";
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
</script>

</head>

<body class="dark-theme" gtools_scp_screen_capture_injected="true">
    <header id="header" class="header bg-white">
        <div class="navbar-container">
            <a href="Javascript:;" onclick="onClickLogo()" title="访问 Tate & Snow" class="navbar-logo menu-logo">
                <img src="http://localhost:2333/style/images/tate.png" alt="Tate & Snow"> </a>
            <!-- <a href="/?tate" title="访问 Tate & Snow" class="navbar-logo">Tate & Snow</a>   -->
            <div class="navbar-menu">
                
                  <a class=" menu-item-categories " href="Javascript:;" onclick="onClickMenu('首页', '/')" title="访问 首页" data-hover="首页">首页</a>
                
                  <a class=" menu-item-categories " href="Javascript:;" onclick="onClickMenu('前端', '/front')" title="访问 前端" data-hover="前端">前端</a>
                
                  <a class=" menu-item-categories " href="Javascript:;" onclick="onClickMenu('历史', '/history')" title="访问 历史" data-hover="历史">历史</a>
                
                  <a class=" menu-item-categories " href="Javascript:;" onclick="onClickMenu('其他', '/other')" title="访问 其他" data-hover="其他">其他</a>
                
                  <a class=" menu-item-categories " href="Javascript:;" onclick="onClickMenu('标签', '/tags')" title="访问 标签" data-hover="标签">标签</a>
                
                  <a class=" menu-item-about " href="Javascript:;" onclick="onClickMenu('关于', '/README')" title="访问 关于" data-hover="关于">关于</a>
                
            </div>
            <!-- <div class="navbar-menu">
                
                <a href="http://localhost:2333/">首页</a>
                
                <a href="http://localhost:2333/front">前端</a>
                
                <a href="http://localhost:2333/history">历史</a>
                
                <a href="http://localhost:2333/other">其他</a>
                
                <a href="http://localhost:2333/tags">标签</a>
                
                <a href="http://localhost:2333/README">关于</a>
                
            </div> -->
            <div class="navbar-search menu-item-search" onclick="onClickSearch()">
                <span class="icon-search"></span>
                <form id="cb-search-btn" role="search">
                    <span class="search-box">
                        <input type="text" class="input" id="cb-search-content" required="true" placeholder="标题 标签..." maxlength="30" autocomplete="off">
                    </span>
                </form>
            </div>
            <div class="navbar-mobile-menu" onclick="">
                <span class="icon-menu cross">
                    <span class="middle"></span>
                </span>
                <ul>
                    
                    <li>
                        <a class="menu-item-categories" href="Javascript:;" onclick="onClickMenu('首页', 'http://localhost:2333/')">首页</a>
                    </li>
                    
                    <li>
                        <a class="menu-item-categories" href="Javascript:;" onclick="onClickMenu('前端', 'http://localhost:2333/front')">前端</a>
                    </li>
                    
                    <li>
                        <a class="menu-item-categories" href="Javascript:;" onclick="onClickMenu('历史', 'http://localhost:2333/history')">历史</a>
                    </li>
                    
                    <li>
                        <a class="menu-item-categories" href="Javascript:;" onclick="onClickMenu('其他', 'http://localhost:2333/other')">其他</a>
                    </li>
                    
                    <li>
                        <a class="menu-item-categories" href="Javascript:;" onclick="onClickMenu('标签', 'http://localhost:2333/tags')">标签</a>
                    </li>
                    
                    <li>
                        <a class="menu-item-categories" href="Javascript:;" onclick="onClickMenu('关于', 'http://localhost:2333/README')">关于</a>
                    </li>
                    
                </ul>
            </div>
        </div>
    </header>
    <a href="#header" class="back-to-top" onclick="onClickTop('TypeScript 问题收集')">⤴Top⤴</a>
    <div class="post-header-thumb bg-white}">
        <div class="post-header-thumb-op"></div>
        <div class="post-header-thumb">
            <div class="post-header-thumb-container">
                <h1 class="post-title" itemprop="name headline">
                    TypeScript 问题收集</h1>
                <div class="post-data">
                    <time datetime="2021-01-21 22:47:00" itemprop="datePublished">
                      发布时间：2021-01-21 22:47:00
                      &nbsp;&nbsp;&nbsp;
                      
                        修改时间：2021-01-25 15:28:00
                      
                    </time>
                    <a onclick="onClickCategory('前端')" href="Javascript:;" title="访问 前端" data-hover="博客分类: 前端">博客分类: 前端</a>
                    <!-- <a href="#read"> 阅读次数: comments</a>  -->
                </div>
                <div class="post-tags">
                       
                    <a class="menu-item-tags" href="Javascript:;" onclick="onClickTag('TS')" title="访问TS" data-hover="TS">
                        TS
                        <span>(3)</span>
                        
                    </a>
                       
                </div>
            </div>
        </div>
    </div>
    <article class="main-content post-page" itemscope itemtype="http://schema.org/Article">
        <div class="post-header">
            <h1 class="post-title" itemprop="name headline">
                TypeScript 问题收集</h1>
            <div class="post-data">
                <time datetime="2021-01-21 22:47:00" itemprop="datePublished">2021-01-21 22:47:00</time>
            </div>
        </div>
        <div id="post-content" class="post-content" itemprop="articleBody">
            <p class="post-tags">
                   
                <a href="Javascript:;" onclick="onClickTag('TS')" title="访问TS" data-hover="TS">
                    TS
                    <span>(3)</span>
                    </a>
                   
            </p>
            <h1 id="typescript-问题收集">TypeScript 问题收集</h1>

<h2 id="更新点">更新点</h2>

<h3 id="import-type">import type</h3>

<p>在以往版本中，如果我们要导入一个值或类型，直接全部导入即可，在 TS 转 JS 的时候，TS 会识别出那些导入项被当做类型使用，并将其删除。但是有时候 TS 并不能识别我们导入的到底是值还是类型。<a href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-3-8.html#type-only-imports-and-export"><strong>Typescript 3.8</strong></a> 里新增了一个新的语法 <code class="highlighter-rouge">import type</code>，即仅导入类型。同样 <code class="highlighter-rouge">export type</code> 仅提供一个用于类型的导出，最终都会被删除:</p>

<pre><code class="language-JS">import type { SomeThing } from "./some-module.js"

export type { SomeThing }
</code></pre>

<blockquote>
  <p>if you’ve hit issues under <code class="highlighter-rouge">--isolatedModules</code>, TypeScript’s <code class="highlighter-rouge">transpileModule</code> API, or <code class="highlighter-rouge">Babel</code>, this feature might be relevant.</p>
</blockquote>

<p>需要注意的是，当使用仅类型导入功能时，导入 class 的话不能对其进行扩展:</p>

<pre><code class="language-JS">import type { Component } from "react"

interface ButtonProps {
  // ...
}

class Button extends Component&lt;ButtonProps&gt; {
  //                 ~~~~~~~~~
  // error! 'Component' only refers to a type, but is being used as a value here.
  // ...
}
</code></pre>

<h3 id="top-level-await">Top-Level Await</h3>

<p>一般情况下我们在使用 await 语法的时候，必须包裹在 async 函数中，然后立即调用该函数来执行异步操作:</p>

<pre><code class="language-JS">async function main() {
  const response = await fetch("...");
  const greeting = await response.text();
  console.log(greeting);
}

main().catch((e) =&gt; console.error(e));
</code></pre>

<p><a href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-3-8.html#top-level-await"><strong>Typescript 3.8</strong></a> 新增了 <code class="highlighter-rouge">Top-Level Await</code> 来省去这部分包装代码。此外注意一点，<code class="highlighter-rouge">Top-Level await</code> 只在顶级模块工作，所以代码中需要含有 export 或者 import 才会认为该文件是一个模块。对于没有依赖的情况下，可以使用 <code class="highlighter-rouge">export {}</code>:</p>

<pre><code class="language-JS">// 顶级模块
const response = await fetch("...");
const greeting = await response.text();
console.log(greeting);

// Make sure we're a module
export {};
</code></pre>

<h3 id="bigint">bigint</h3>

<p><a href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-3-2.html#bigint"><strong>Typescript 3.2</strong></a> 针对于 <a href="( http://localhost:2333/2020/05/05/js-floating-points.html#bigint )"><strong>BigInt</strong></a> 类型做了支持，表示为小写的 <strong>bigint</strong>。需要注意的是，bigint 和 number 是两种不同的类型:</p>

<pre><code class="language-JS">declare let foo: number;
declare let bar: bigint;

foo = bar; // error: Type 'bigint' is not assignable to type 'number'.
bar = foo; // error: Type 'number' is not assignable to type 'bigint'.

// 混合计算使用的时候，必须将数字类型转换为 bigint
console.log(3.141592 * 10000n); // error
console.log(3145 * 10n); // error
console.log(BigInt(3145) * 10n); // okay!
</code></pre>

<h3 id="ts-nocheck--ts-ignore">@ts-nocheck / @ts-ignore</h3>

<p>为了让用户能从 JS 到 TS 平滑过渡，原先能通过 <code class="highlighter-rouge">--allowJs</code> 来支持 TS 和 JS 文件的混合在一起编译，不会对 JS 文件去做类型检查。<a href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-3.html#errors-in-js-files-with---checkjs"><strong>Typescript 2.3</strong></a> 可以通过两种方式来实现对混合在一起的 JS 文件一起做类型检查:</p>

<ol>
  <li>通过开启 <code class="highlighter-rouge">--checkJs</code> 配置来对 JS 文件去做检测。在 JS 文件中，可以通过在顶部添加 <code class="highlighter-rouge">@ts-nocheck</code> 注释跳过该文件类型检测，也可以通过添加 <code class="highlighter-rouge">@ts-ignore</code> 注释跳过下一行的文件类型检测</li>
  <li>直接通过 <code class="highlighter-rouge">@ts-check</code> 对 JS 文件去做检测</li>
</ol>

<p>并且做类型检测的时候，还可以根据 jsdoc 的类型注解自动来进行判断:</p>

<pre><code class="language-JS">// @ts-check

/**
 * @param {string} input
*/
function foo ( input ) {
  input.tolowercase ()
      // ~~~~~~~~~~~ Error!  Should be toLowerCase
} 
</code></pre>

<blockquote>
  <p>到了 <a href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-3-7.html#-ts-nocheck-in-typescript-files"><strong>Typescript 3.7</strong></a>，<code class="highlighter-rouge">@ts-nocheck</code> 的注释也可以不仅仅针对 JS 文件，同样可以作用于 TS 文件。</p>
</blockquote>

<blockquote>
  <p>到了 <a href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-4-1.html#checkjs-implies-allowjs"><strong>Typescript 4.1</strong></a>，设置 <code class="highlighter-rouge">--checkJs</code> 的时候会默认开通 <code class="highlighter-rouge">--allowJS</code></p>
</blockquote>

<h3 id="ts-expect-error">@ts-expect-error</h3>

<p>当我们通过 <code class="highlighter-rouge">@ts-expect-error</code> 来进行注释时，TS 抛出的类型错误会被忽略；如果没有错误，则会抛出异常 <code class="highlighter-rouge">Unused '@ts-expect-error' directive.</code>。通常我们的使用场景可能是单元测试，比如:</p>

<pre><code class="language-JS">function doStuff(abc: string, xyz: string) {
  assert(typeof abc === "string");
  assert(typeof xyz === "string");

  // do some stuff
}
</code></pre>

<pre><code class="language-JS">// 单元测试
expect(() =&gt; {
  doStuff(123, 456);
}).toThrow();
</code></pre>

<p>如果单元测试也是用 TS 来编写的话，那么我们可以看到如下的报错:</p>

<pre><code class="language-JS">doStuff(123, 456);
//           ~~~
// error: Type 'number' is not assignable to type 'string'.
</code></pre>

<p>因此通过上述的注释我们就能跳过这个类型检测。但有一个问题，它在功能上和 <code class="highlighter-rouge">@ts-ignore</code> 很相似呀，为啥要单独引入这个指令呢，你会 pick 谁？下面是官网贴出来的两者的比较:</p>

<ul>
  <li>Pick ts-expect-error if:</li>
</ul>

<ol>
  <li>you’re writing test code where you actually want the type system to error on an operation</li>
  <li>you expect a fix to be coming in fairly quickly and you just need a quick workaround</li>
  <li>you’re in a reasonably-sized project with a proactive team that wants to remove suppression comments as soon affected code is valid again</li>
</ol>

<ul>
  <li>Pick ts-ignore if:</li>
</ul>

<ol>
  <li>you have a larger project and new errors have appeared in code with no clear owner</li>
  <li>you are in the middle of an upgrade between two different versions of TypeScript, and a line of code errors in one version but not another.</li>
  <li>you honestly don’t have the time to decide which of these options is better.</li>
</ol>

<h3 id="template-literal-types">Template Literal Types</h3>

<p><a href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-4-1.html#template-literal-types"><strong>Typescript 4.1</strong></a> 里引入了字符串模板类型，简单的看下:</p>

<pre><code class="language-JS">type Color = "red" | "blue";
type Quantity = "one" | "two";

type SeussFish = `${Quantity | Color} fish`;
//   ^ = type SeussFish = "one fish" | "two fish" | "red fish" | "blue fish"
</code></pre>

<p>我们也可以举个实际一点的栗子，比如要传入一些位移参数:</p>

<pre><code class="language-JS">type VerticalAlignment = "top" | "middle" | "bottom"
type HorizontalAlignment = "left" | "center" | "right"

// Takes
//   | "top-left"    | "top-center"    | "top-right"
//   | "middle-left" | "middle-center" | "middle-right"
//   | "bottom-left" | "bottom-center" | "bottom-right"

declare function setAlignment(value: `${VerticalAlignment}-${HorizontalAlignment}`): void

setAlignment("top-left");   // works!
setAlignment("top-middel"); // error!
// Argument of type '"top-middel"' is not assignable to parameter of type '"top-left" | "top-center" | "top-right" | "middle-left" | "middle-center" | "middle-right" | "bottom-left" | "bottom-center" | "bottom-right"'.
</code></pre>

<p>再看个稍微复杂点的栗子:</p>

<pre><code class="language-JS">type PropEventSource&lt;T&gt; = {
  on&lt;K extends string &amp; keyof T&gt;
    (eventName: `${K}Changed`, callback: (newValue: T[K]) =&gt; void ): void;
};

declare function makeWatchedObject&lt;T&gt;(obj: T): T &amp; PropEventSource&lt;T&gt;;

let person = makeWatchedObject({
  firstName: "Homer",
  age: 42,
  location: "Springfield",
});

// works! 'newName' is typed as 'string'
person.on("firstNameChanged", newName =&gt; {
  // 'newName' has the type of 'firstName'
  console.log(`new name is ${newName.toUpperCase()}`);
});

// works! 'newAge' is typed as 'number'
person.on("ageChanged", newAge =&gt; {
  if (newAge &lt; 0) {
    console.log("warning! negative age");
  }
})
</code></pre>

<h3 id="key-remapping-in-mapped-types">Key Remapping in Mapped Types</h3>

<p>映射类型可以基于任意键创建新的对象类型，打个比方:</p>

<pre><code class="language-JS">type Options = {
  [K in "noImplicitAny" | "strictNullChecks" | "strictFunctionTypes"]?: boolean
};
// same as
//   type Options = {
//     noImplicitAny?: boolean,
//     strictNullChecks?: boolean,
//     strictFunctionTypes?: boolean
//   };
</code></pre>

<p>但是我们目前能够做的只是在给出的值里面去生成 key，而不能映射到其他 key 值，<a href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-4-1.html#template-literal-types"><strong>Typescript 4.1</strong></a> 通过 <strong>as</strong> 提供了重新映射的功能:</p>

<pre><code class="language-JS">type Getters&lt;T&gt; = {
  [K in keyof T as `get${Capitalize&lt;string &amp; K&gt;}`]: () =&gt; T[K]
};

interface Person {
  name: string
  age: number
  location: string
}

type LazyPerson = Getters&lt;Person&gt;
//   ^ = type LazyPerson = {
//       getName: () =&gt; string;
//       getAge: () =&gt; number;
//       getLocation: () =&gt; string;
//   }
</code></pre>

<p>我们还可以利用这个实现 Omit 的效果:</p>

<pre><code class="language-JS">// Remove the 'kind' property
type RemoveKindField&lt;T&gt; = {
  [K in keyof T as Exclude&lt;K, "kind"&gt;]: T[K]
};

interface Circle {
  kind: "circle"
  radius: number
}

type KindlessCircle = RemoveKindField&lt;Circle&gt;;
//   ^ = type KindlessCircle = {
//       radius: number
//   }
</code></pre>

<h2 id="问题收集">问题收集</h2>

<h3 id="union-type-with-filter--map">union type with filter / map</h3>

<p>对于一个变量是联合数组类型(union type)时，无法调用其 filter 或者 map 方法:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">person</span><span class="p">:</span> <span class="nx">string</span><span class="p">[]</span> <span class="o">|</span> <span class="nx">number</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[]</span>

<span class="nx">person</span><span class="p">.</span><span class="nx">filter</span><span class="p">((</span><span class="nx">p</span><span class="p">:</span> <span class="nx">string</span> <span class="o">|</span> <span class="nx">number</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="nx">v</span> <span class="o">!==</span> <span class="kc">null</span><span class="p">)</span>
</code></pre></div></div>

<p><img src="http://localhost:2333/style/images/smms/ts-filter-map.png" alt="filter map" /></p>

<p>很显然 person.filter 肯定是可调用方法，但是 TS 对于这种情况的提示却是 The expression is not callable。解决办法是可以把数组类型由联合数组变为数组元素为联合类型，如下。推荐阅读：<a href="https://www.typescriptlang.org/docs/handbook/release-notes/typescript-3-3.html#key-remapping-in-mapped-types"><strong>TypeScript 3.3</strong></a>。</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">person</span><span class="p">:</span> <span class="o">&lt;</span><span class="nx">string</span><span class="o">|</span> <span class="nx">number</span><span class="o">&gt;</span><span class="p">[]</span> <span class="o">=</span> <span class="p">[]</span>
</code></pre></div></div>

<h3 id="operands-for-delete-must-be-optional">Operands for delete must be optional</h3>

<p>当使用 delete 操作符，运算元必须为 <code class="highlighter-rouge">any, unknown, never</code>，或者为可选(因为其类型中包含了 undefined)。否则会报错:</p>

<pre><code class="language-JS">interface Thing {
  prop: string
}

function f(x: Thing) {
  delete x.prop // The operand of a 'delete' operator must be optional.
}
</code></pre>

<p>修改的方式也很简单，只要把相关属性改为 optional 即可:</p>

<pre><code class="language-JS">interface Thing {
  prop?: string
}
</code></pre>

<p>如果碰到比较复杂的栗子，比如接口定义了多个属性的话，还可以用以下自定义类型去修改:</p>

<pre><code class="language-JS">export type TPickPartial&lt;T, K extends keyof T&gt; = Pick&lt;T, Exclude&lt;keyof T, K&gt;&gt; &amp; Partial&lt;Pick&lt;T, K&gt;&gt;

// 例如
type TTest = TPickPartial&lt;TAnotherTest, 'canSort' | 'scenes'&gt;
</code></pre>

<h3 id="objectkeys-using-numbers">Object.keys using numbers</h3>

<p>调用 <strong>Object.keys</strong> 获取对象的 key 值，在类型检测时默认为 <code class="highlighter-rouge">string[]</code>，这样就会有个问题:</p>

<pre><code class="language-JS">type Foo = { [key: number]: string }

const foo: Foo = { 100: 'foo', 200: 'bar' }
const sizes: number[] = Object.keys(foo) // Type 'string[]' is not assignable to type 'number[]
</code></pre>

<p>因此我们必须将字符串类型先转换为数字，最简单的方法是通过 map 来实现:</p>

<pre><code class="language-JS">const sizes: number[] = Object.keys(foo).map(Number)
</code></pre>

<p>来看个完整一点的栗子:</p>

<pre><code class="language-JS">const weekMapping = {
  1: '周一',
  2: '周二',
  3: '周三',
  4: '周四',
  5: '周五',
  6: '周六',
  7: '周日',
}

type TWeekKey = keyof typeof weekMapping

const keys = Object.keys(weekMapping).map(Number) as Array&lt;TWeekKey&gt;

function WeekSelector() {
  return (
    keys.map(key =&gt; (
      &lt;Button key={key}&gt;{weekMapping[key]}&lt;/Button&gt;
    ))
  )
}
</code></pre>
 
<div id="gitalk-container"></div>
<script>
    var gitalk = new Gitalk({
      enable: true,
      clientID: '020f142489f80c92b097',
      clientSecret: '1fa083372b44031cf1b8249251515c4e3d54c69d',
      repo: 'tate-young.github.io',
      owner: 'Tate-Young',
      admin: ['Tate-Young'],
      id: location.pathname,      // Ensure uniqueness and length less than 50
      distractionFreeMode: false  // Facebook-like distraction free mode
    })

    gitalk.render('gitalk-container')
</script>
<!-- disqus -->
<!-- <div id="disqus_thread"></div>
<script>
    /**
     *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
     *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
     */

    var disqus_config = function () {
        this.page.url = 'https://tate-young.github.io/2021/01/21/ts-update.html';
        this.page.identifier = '/2021/01/21/ts-update';
        this.page.title = 'TypeScript 问题收集';
    };

    (function () { // REQUIRED CONFIGURATION VARIABLE: EDIT THE SHORTNAME BELOW
        var d = document,
            s = d.createElement('script');

        s.src = '//tate.disqus.com/embed.js'; // IMPORTANT: Replace EXAMPLE with your forum shortname!

        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the
    <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a>
</noscript> -->


            <!-- <p class="post-info">
			本文由 <a href="/">liberxue</a> 创作，采用 <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="external nofollow">知识共享署名4.0</a> 国际许可协议进行许可<br>本站文章除注明转载/出处外，均为本站原创或翻译，转载前请务必署名<br>最后编辑时间为:2021-01-21 22:47:00</p> -->
        </div>
    </article>

    <!-- <div class="related-post-lists">
	<div class="post-lists">
		<div class="post-lists-body">
					<div class="post-list-item">
				<div class="post-list-item-container">
					<div class="item-label">
						<div class="item-title"><a href="induction.html">归纳的随想</a></div>
						<div class="item-meta clearfix">
														<div class="item-meta-ico bg-ico-image" style="background: url('../usr/themes/pinghsu/images/bg-ico.png') no-repeat;background-size: 40px auto;"></div>
	                        							<div class="item-meta-cat"><a href="../category/thoughts/index.html">Thoughts</a></div>
						</div>
					</div>
				</div>
			</div>
				</div>
	</div>
</div> -->

    <!-- <footer class="footer bg-white">
	<div class="footer-social">
		<div class="footer-container clearfix">
			<div class="social-list">
	 <a class="social segmentfault" target="blank" href="https://segmentfault.com/u/liberxue" title="访问 LiberXue_Twitter" data-hover="Segmentfault">Segmentfault</a>
    <a class="social github" target="blank" href="https://github.com/liberxue" title="访问 LiberXue_Twitter" data-hover="GitHub">GitHub</a>
    <a class="social twitter" target="blank" href="http://twitter.com/liberxue" title="访问 LiberXue_Twitter" data-hover="Twitter">Twitter</a>
     <a class="social stackoverflow" target="blank" href="https://stackoverflow.com/users/6902190/liberxue" title="访问 LiberXue_stackoverflow" data-hover="StackOverflow">StackOverflow</a>
          <a class="social oschina" target="blank" href="https://my.oschina.net/bolanzw" title="访问 LiberXue_Oschina" data-hover="Oschina">Oschina</a>
     <a class="social rss" target="blank" href="/feed.xml"title="访问 LiberXue_RSS" data-hover="RSS">RSS</a>
	</div>
		</div>
	</div>
	<div class="footer-meta">
        <div class="footer-container">
            <div class="meta-item meta-copyright">
                <div class="meta-copyright-info">
                    <a href="/" class="info-logo">
                         <img src="http://localhost:2333/style/images/logo-liberxue.png"   title="访问 LiberXue_blog" data-hover="LiberXue_blog" alt="LiberXue_blog" /> </a>
                    <div class="info-text">
                        <p>Theme is <a href="http://www.liberxue.com/2017/08/03/Jekyllthemes.html" title="访问 Jekyll liberxue主题"  data-hover="Jekyll liberxue"target="_blank">Jekyll liberxue</a> by <a href="http://www.liberxue.com/about" target="_blank">liberxue</a></p>
                        <p>Powered by <a href="http://localhost:2333/tags/#Jekyll" title="Jekyll" data-hover="Jekyll" target="_blank" rel="nofollow">Jekyll</a></p>
                        <p>&copy; 2017 <a href="/feed.xml"  title="访问 liberxue blog RSS" data-hover="liberxue blog RSS">liberxue blog RSS</a></p>
                        <p>总计文章：篇</p>
                      <p>本blog已开源点击Fork</p><iframe src="http://ghbtns.com/github-btn.html?user=liberxue&repo=liberxue.github.io&type=fork&count=true" allowtransparency="true" frameborder="0" scrolling="0" width="95" height="20"></iframe>
                    </div>
                </div>
            </div>
            <div class="meta-item meta-posts">
                <h3 class="meta-title">置顶文章</h3>
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
            </div>
            <div class="meta-item meta-comments">
                <h3 class="meta-title">最新文章</h3>
  
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
      
    
</div>
		</div>
    </div>
</footer> -->
<script src="//cdn.bootcss.com/jquery/2.2.2/jquery.min.js"></script>
<script src="//cdn.bootcss.com/bootstrap-3-typeahead/4.0.2/bootstrap3-typeahead.js"></script>
<script async src="/search/js/520.js"></script>
<script async src="/search/js/gtag.js"></script>
<!-- <script async src="/search/live2d/autoload.js"></script> -->
<!-- <script src="/search/js/canvas.js"></script> -->

<script>
    $(function () {
        setTimeout(function () {
            $('code').removeClass('hljs');
            $('code').removeClass('language');
        }, 90);
    });
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>

    <!--liberxueconnnet-menu-->
    <div id="directory-content" class="directory-content">
        <div id="directory"></div>
    </div>
    <!--liberxueconnnet-menu-->
    <script>
      const directoryContainer = document.getElementById('directory')
      const postTitle = document.getElementsByClassName('post-title')[0]
      var postDirectoryBuild = function () {
        var postChildren = function children(childNodes, reg) {
          var result = [],
              isReg = typeof reg === 'object',
              isStr = typeof reg === 'string',
              node, i, len;
          for (i = 0, len = childNodes.length; i < len; i++) {
            node = childNodes[i];
            if ((node.nodeType === 1 || node.nodeType === 9) &&
              (!reg ||
                  isReg && reg.test(node.tagName.toLowerCase()) ||
                  isStr && node.tagName.toLowerCase() === reg)) {
                result.push(node);
              }
            }
            return result;
          },
          createPostDirectory = function (article, directory, isDirNum) {
            var contentArr = [],
                titleId = [],
                levelArr, root, level,
                currentList, list, li, link, i, len;
            levelArr = (function (article, contentArr, titleId) {
                  var titleElem = postChildren(article.childNodes, /^h\d$/),
                      levelArr = [],
                      lastNum = 1,
                      lastRevNum = 1,
                      count = 0,
                      guid = 1,
                      id = 'directory' + (Math.random() + '').replace(/\D/, ''),
                      lastRevNum, num, elem;
                  while (titleElem.length) {
                      elem = titleElem.shift();
                      contentArr.push(elem.innerHTML);
                      num = +elem.tagName.match(/\d/)[0];
                      if (num > lastNum) {
                          levelArr.push(1);
                          lastRevNum += 1;
                      } else if (num === lastRevNum ||
                          num > lastRevNum && num <= lastNum) {
                          levelArr.push(0);
                          lastRevNum = lastRevNum;
                      } else if (num < lastRevNum) {
                          levelArr.push(num - lastRevNum);
                          lastRevNum = num;
                      }
                      count += levelArr[levelArr.length - 1];
                      lastNum = num;
                      elem.id = elem.id || (id + guid++);
                      titleId.push(elem.id);
                  }
                  if (count !== 0 && levelArr[0] === 1) levelArr[0] = 0;

                  return levelArr;
              })(article, contentArr, titleId);
              currentList = root = document.createElement('ul');
              dirNum = [0];
              for (i = 0, len = levelArr.length; i < len; i++) {
                  level = levelArr[i];
                  if (level === 1) {
                      list = document.createElement('ul');
                      if (!currentList.lastElementChild) {
                          currentList.appendChild(document.createElement('li'));
                      }
                      currentList.lastElementChild.appendChild(list);
                      currentList = list;
                      dirNum.push(0);
                  } else if (level < 0) {
                      level *= 2;
                      while (level++) {
                          if (level % 2) dirNum.pop();
                          currentList = currentList.parentNode;
                      }
                  }
                  dirNum[dirNum.length - 1]++;
                  li = document.createElement('li');
                  link = document.createElement('a');
                  link.name = '#' + titleId[i];
                  link.href = 'Javascript:;'
                  link.className = "post-aside-anchor"
                  link.title = '访问' + titleId[i];
                  link.innerHTML = !isDirNum ? contentArr[i] :
                      dirNum.join('.') + ' ' + contentArr[i];
                  li.appendChild(link);
                  currentList.appendChild(li);
              }
            directory.appendChild(root);
          };
        createPostDirectory(document.getElementById('post-content'), directoryContainer, true);
      };
      postDirectoryBuild();
    </script>
    <script>
      // gtag('config', GA_TRACKING_ID, {
      //   'page_title' : 'Blog',
      //   'page_path': window.location.pathname,
      //   'post_title': 'watttsdfasdf',
      // });

    </script>
    <script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
    <script>
        lang = hljs.initHighlightingOnLoad();
    </script>
</body>

</html>
