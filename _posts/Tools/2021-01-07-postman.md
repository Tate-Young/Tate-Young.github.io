---
layout: blog
front: true
comments: True
flag: HTML
background: green
category: å‰ç«¯
title: postman å°æŠ€å·§
date:   2021-01-07 21:54:00 GMT+0800 (CST)
background-image: https://miro.medium.com/max/1400/1*KAtiIej7Eydfpn5FWgwpgw.png
tags:
- webpack
---
# {{ page.title }}

[**postman**](https://learning.postman.com/docs/sending-requests/requests/) ä½¿ç”¨è¿™ä¹ˆä¹…äº†ï¼Œä½†æ˜¯è¿˜æ˜¯æœ‰ä¸€äº›å¥½ç”¨çš„å°åŠŸèƒ½è¢«é—å¿˜ï¼Œè¿™æ¬¡å°±ç¨å¾®æ•´ç†ä¸€ä¸‹å§ã€‚å¯¹äºŽå‰ç«¯è€Œè¨€ï¼Œå®ƒæœ€å¤§çš„åŠŸèƒ½èŽ«è¿‡äºŽæŽ¥å£è°ƒè¯•æˆ–æµ‹è¯•ï¼Œè¿™é‡Œä¹Ÿæåˆ°ä¸¤ä¸ªå‘½ä»¤ **curl** å’Œ **httpie**ï¼Œæœ‰å…´è¶£çš„å¯ä»¥åŽ»çœ‹[è¿™ç¯‡æ–‡ç« ](( {{site.url}}/2018/04/15/linux-command.html#curl--httpie )) ðŸ‘ˆ

![postman]( {{site.url}}/style/images/smms/postman-interface.png )

## å˜é‡

å˜é‡å¯ä»¥ä½¿æˆ‘ä»¬åœ¨è¯·æ±‚æˆ–è„šæœ¬ä¸­å­˜å‚¨å’Œé‡å¤ä½¿ç”¨å…¶å€¼ï¼Œé€šè¿‡å°†å€¼ä¿å­˜åœ¨å˜é‡ä¸­ï¼Œå¯ä»¥åœ¨é›†åˆï¼ŒçŽ¯å¢ƒæˆ–è¯·æ±‚ä¸­å¼•ç”¨ï¼Œä¹Ÿæ–¹ä¾¿ç®¡ç†å’Œä¿®æ”¹ã€‚æ ¹æ®ä½œç”¨åŸŸå±‚çº§ä¸»è¦å¯ä»¥åˆ†ä¸º:

* **global** - å…¨å±€
* **collection** - é›†åˆ
* **environment**  - çŽ¯å¢ƒ

![variables](https://assets.postman.com/postman-docs/env-quick-look.jpg)

1. **initial value** - å½“ä½ åˆ†äº«è¯¥é›†åˆæˆ–çŽ¯å¢ƒå˜é‡æ—¶ï¼Œå¯¹æ–¹æ‹¿åˆ°çš„å€¼
2. **current value** - æœ¬åœ°çš„å€¼ï¼Œä¸ä¼šè¢«åŒæ­¥ã€‚å¯ä»¥ç‚¹å‡» persist æŒ‰é’®åŒæ­¥åˆ° initial value

> è¿˜æœ‰ä¸¤ç§ä¸º data å’Œ localï¼Œè¿™é‡Œä¸åšä»‹ç»

> postman å­˜å‚¨å˜é‡æ—¶ä¼šä½¿ç”¨å­—ç¬¦ä¸²ï¼Œæ‰€ä»¥å¦‚æžœæ˜¯å¯¹è±¡æˆ–æ•°ç»„ï¼Œå¯ä»¥å…ˆä½¿ç”¨ `JSON.stringify()` åºåˆ—åŒ–ï¼Œä½¿ç”¨çš„æ—¶å€™ `JSON.parse()` è§£æžå³å¯

### è®¾ç½®å˜é‡

è®¾ç½®å˜é‡æœ‰å¥½å¤šç§æ–¹å¼ï¼Œå¯ä»¥ç‚¹å‡»åˆ°é¡µé¢ä¸­ç›¸åº”ä½ç½®è¿›è¡Œç¼–è¾‘ï¼Œä¹Ÿå¯ä»¥ç›´æŽ¥åœ¨éœ€è¦è®¾ç½®çš„å˜é‡ä¸Šå³é”®:

![set as var](https://assets.postman.com/postman-docs/set-as-var-prompt.jpg)

![set var text](https://assets.postman.com/postman-docs/set-var-text.jpg)

è¿˜å¯ä»¥é€šè¿‡è„šæœ¬æ¥åˆ›å»º:

```JS
// global
pm.globals.set('key', 'value');

// collection
pm.collectionVariables.set('key', 'value');

// environment æ³¨æ„æ˜¯ä»…é™äºŽå½“å‰çš„çŽ¯å¢ƒ
pm.environment.set('key', 'value');

// local - æœ¬åœ°å˜é‡ä¼˜å…ˆçº§æœ€é«˜ï¼Œå¯è¦†ç›–å…¶ä»–å˜é‡ã€‚ä¸€èˆ¬åªåšä¸´æ—¶è¦†ç›–å…¶ä»–å˜é‡æ¥ä½œæµ‹è¯•
pm.variables.set('key', 'value');

// åŒæ ·ä¹Ÿå¯ä»¥åˆ é™¤æŸä¸ªå˜é‡
pm.environment.unset('key');
```

### èŽ·å–å˜é‡

èŽ·å–å˜é‡å¯ä»¥ä½¿ç”¨åŒå¤§æ‹¬å·çš„æ’å€¼è¡¨è¾¾å¼ï¼Œåœ¨è¾“å…¥çš„æ—¶å€™é»˜è®¤ä¼šæœ‰è”æƒ³:

![get var](https://assets.postman.com/postman-docs/vars-in-request.jpg)

å®šä¹‰å¥½çš„å˜é‡ä¹Ÿå¯ä»¥åœ¨è„šæœ¬ä¸­ç›´æŽ¥ä½¿ç”¨ï¼Œè¿˜æœ‰ä¸€äº›ä»¥ $ å¼€å¤´çš„å†…ç½®çš„åŠ¨æ€å˜é‡ï¼Œè¯¦ç»†çš„åˆ—è¡¨å¯ä»¥[å‚è€ƒè¿™é‡Œ](https://learning.postman.com/docs/writing-scripts/script-references/variables-list/) ðŸ‘ˆ:

1. \{\{$guid}} - A v4 style guid
2. \{\{$timestamp}} - The current timestamp (Unix timestamp in seconds)
3. \{\{$randomInt}} - A random integer between 0 and 1000

```JS
// global
pm.globals.get('key');

// èŽ·å–åŠ¨æ€å˜é‡çš„å€¼ï¼Œéœ€è¦ä½¿ç”¨ replaceIn æ–¹æ³•
pm.variables.replaceIn('\{\{$randomFirstName}}') // Julian
```

### ä½¿ç”¨åœºæ™¯

#### è¯·æ±‚å‰ç½®è„šæœ¬

å‰ç½®è„šæœ¬å…¶å®žå°±æ˜¯åœ¨ `Pre-requests Script` ä¸­ç¼–å†™çš„ JS è„šæœ¬ï¼Œå½“ä¸€ä¸ªè¯·æ±‚åœ¨å‘é€ä¹‹å‰ï¼Œä¼šå…ˆåŽ»æ‰§è¡Œå‰ç½®è„šæœ¬ä¸­çš„ä»£ç ï¼Œå› æ­¤æœ‰å‡ ä¸ªåœºæ™¯å¾ˆé€‚ç”¨ï¼Œæ¯”å¦‚ç™»å½•æŽ¥å£çš„å¯†ç ï¼Œåœ¨å‘é€å‰éœ€è¦åšåŠ å¯†å¤„ç†ï¼Œé‚£ä¹ˆå°±å¯ä»¥åœ¨å‰ç½®è„šæœ¬ä¸­åšåŠ å¯†å¤„ç†ï¼›å†æ¯”å¦‚è¯´ï¼Œæœ‰çš„æŽ¥å£çš„è¾“å…¥å‚æ•°æœ‰ä¸€äº›éšæœºæ•°ï¼Œæ¯è¯·æ±‚ä¸€æ¬¡æŽ¥å£å‚æ•°å€¼éƒ½ä¼šå‘é€å˜åŒ–ï¼Œå°±å¯ä»¥åœ¨å‰ç½®è„šæœ¬ä¸­ç¼–å†™ç”Ÿæˆéšæœºæ•°çš„ä»£ç ã€‚æ€»ä½“æ¥è¯´ï¼Œå°±æ˜¯åœ¨è¯·æ±‚æŽ¥å£ä¹‹å‰å¯¹æˆ‘ä»¬çš„è¯·æ±‚æ•°æ®è¿›è¡Œè¿›ä¸€æ­¥åŠ å·¥å¤„ç†çš„éƒ½å¯ä»¥ä½¿ç”¨å‰ç½®è„šæœ¬è¿™ä¸ªåŠŸèƒ½:

æ¯”å¦‚ä¸‹å›¾ï¼Œåœ¨è¯·æ±‚ posts æ—¶å¯ä»¥å¸¦ä¸Š id å‚æ•°ï¼Œå¦‚æžœ id æ˜¯éšæœºæ•°çš„è¯ï¼Œåˆ™å¯ä»¥åœ¨è¯·æ±‚å‰å…ˆä¿å­˜åˆ°å˜é‡ä¸­ï¼Œç„¶åŽè¯·æ±‚çš„æ—¶å€™å†ä»Žå˜é‡ä¸­åŽ»èŽ·å–è¯¥å€¼:

![pre-request-script]( {{site.url}}/style/images/smms/postman-pre-request-script.png )

#### æŽ¥å£å…³è”

æœ‰ä¸€ä¸ªåœºæ™¯å°±æ˜¯å…¶ä¸­ä¸€ä¸ªæŽ¥å£éœ€è¦å¦ä¸€ä¸ªæŽ¥å£çš„æ•°æ®ä½œä¸ºè¾“å…¥å‚æ•°ï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªæŽ¥å£å³æœ‰å…³è”ï¼Œæˆ‘ä»¬éœ€è¦åšçš„å°±æ˜¯å…ˆä¿å­˜ç¬¬ä¸€ä¸ªæŽ¥å£çš„ç›¸å…³æ•°æ®ï¼Œç„¶åŽåœ¨ä¸‹ä¸€ä¸ªæŽ¥å£ä¸­åŽ»èŽ·å–è¯¥å˜é‡ã€‚æ¯”å¦‚éœ€è¦æ ¹æ®æ¸¸å®¢ token åŽ»èŽ·å–è®¤è¯ token:

```JS
// åœ¨ç¬¬ä¸€ä¸ªèŽ·å–æ¸¸å®¢ token çš„æŽ¥å£çš„ Tests æµ‹è¯•ä¸­ï¼Œå°†æœ‰æ•ˆä¿¡æ¯ä¿å­˜åˆ° touristToken é›†åˆå˜é‡ä¸­
const { info = '' } = pm.response.json()

pm.collectionVariables.set('touristToken', info)
```

æŽ¥ç€æˆ‘ä»¬åœ¨ç¬¬äºŒä¸ªèŽ·å–è®¤è¯ token çš„æŽ¥å£çš„è¯·æ±‚å¤´ä¸­æ·»åŠ è¯¥å‚æ•°: token: \{\{touristToken}}ï¼Œä¹‹åŽæˆ‘ä»¬è¿˜å¯ä»¥å°†è¯¥ Tests æµ‹è¯•ä¸­å°†èŽ·å–åˆ°çš„è®¤è¯çš„ token åŒæ­¥åˆ°å…¨å±€å˜é‡ä¸­:

```JS
const { info: { member: { token = '' } = {} } = {} } = pm.response.json()

pm.globals.set('token', token)
```

> to be continued
