---
layout: blog
front: true
comments: True
flag: HTML
background: green
category: 前端
title:  JAMstack
date:   2020-01-30 17:11:00 GMT+0800 (CST)
background-image: https://snipcart.com/media/204006/jamstack-vs-wordpress-1.png
tags:
- html
---
# {{ page.title }}

## 什么是 JAMstack

[**JAMstack**](https://jamstack.wtf/#meaning) 是一种现代制作网站方法，提供更好的性能，更高的安全性，更低的扩展成本以及更好的开发人员体验。其中的 JAM 代表了 `JavaScript, API & Markup`:

* **JavaScript** - 通过 JavaScript 处理动态功能，不限使用哪个框架或库
* **API** - 服务器端操作被抽象为可重用的 API，并使用 JavaScript 通过 HTTPS 访问，可以是第三方服务或自定义的功能
* **Markup** - 网站是作为静态 HTML 文件提供的。可以使用**静态站点生成器(static site generator)**从源文件(例如 Markdown)生成

> A modern web development architecture based on client-side JavaScript, reusable APIs, and prebuilt Markup

JAMstack 有很多好处:

1. 更快的性能 - 通过 CDN 提供预先构建的标记文件和资源文件(assets)
2. 更安全 - 无需担心服务器或数据库的漏洞
3. 更便宜 - 托管静态文件很便宜甚至免费
4. 更好的开发体验 - 前端开发人员可以专注于前端，不必依赖于传统的一体化架构
5. 可扩展性 - 如果产品在传播时突然拥有许多活跃用户，CDN 将无缝补齐所需资源

JAMstack 的最佳做法:

1. 使用 CDN - 提供了更好的性能和更轻松的可扩展性
2. 原子部署 - 每个部署都是站点的完整快照，可保证全球网站版本的一致
3. 缓存失效 - 上传新构建的版本后，CDN 使缓存无效，可使新版本即时生效
4. 版本控制 - 把代码放到 Git，可记录每个文件的历史更改，方便协作和追溯
5. 自动构建 - 当需要新构建时，[**webhooks**](https://zh.wikipedia.org/zh-hans/网络钩子) 会通知服务器，构建后实时更新 CDN 和站点

![JAMstack 构建流程](https://1024.com/uploads/editor/11/jnal1ipd7z7q.jpeg)

## 如何构建

### 静态站点生成器

大部分 JAMstack 静态网站都需要静态站点生成器，我们可以根据我们的需求随便选一个。之前博客中介绍的 [Jekyll]( {{site.url}}/2019/10/10/github-pages.html#jekyll ) 就是 SSG 之一，还有 Gatsby 之类的，更多静态站点生成器[可以查看这里](https://www.staticgen.com) 👈

### 部署平台

选择可以部署的平台，比如 Github Pages 或者 Netlify(看清楚了，不是网飞 Netflix 😳) 等，更多平台[可以参考这里](https://www.thenewdynamic.org/tools/hosting-deployment/) 👈

### 动态部分

静态网站不是真的就是静态的，你可以通过一些服务来进行动态数据的传输。下面举几个例子:

1. 自定义函数 - 可以抽象函数为可复用的 API，如 [AWS lambda functions](https://aws.amazon.com/lambda/features/) or [Netlify Functions](https://functions.netlify.com/examples/)
2. 自定义数据 - 很多场景你需要存储一些数据，可以用到 [FaunaDB Serverless GraphQL](https://fauna.com)
3. 评论功能 - 提供评论功能，如 disqus 或者 gitalk 等
4. 还有很多其他功能模块，比如搜索、支付、在线聊天等，更多[可以参考这里](https://github.com/agarrharr/awesome-static-website-services#e-commerce) 👈

> 我们可以在官方网站[找到一些示例](https://jamstack.org/examples/)，也可以找到[丰富多彩的 JAMstack 主题](https://jamstackthemes.dev) 👈

![JAMstack workflow](https://snipcart.com/media/204006/jamstack-vs-wordpress-1.png)

## headless CMS

JAMstack 静态网站可以通过 **CMS(Content Management System)** 内容管理系统来进行管理，比如无头(headless) CMS。当 CMS 上触发某个变动时，会重新自动构建新的网站版本并将其部署为静态资源。

那么问题来了，headless CMS 与传统的 CMS 到底有啥区别呢？

传统的 CMS 内容管理方法是将所有内容集中在一起，包括内容、图片和其他一些资源，这使得内容构建和展示完全耦合，比如 Wordpress，Drupal，Joomla 等。虽然传统上它们都是 CMS，每次提供服务时都必须与网站一起托管和构建。但 headless CMS 不在乎将内容投放到何处，它不再附加到前端，并且可以在任何平台上查看内容。这种方法的优点很大，并且可以与 JAMstack 站点一起使用，与传统站点相比，JAMstack 站点更安全，更方便地进行扩展。如 Strapi、Ghost、Jekyll Admin 等，更多[可以参考这里](https://headlesscms.org) 👈

![headless CMS](https://css-tricks.com/wp-content/uploads/2016/03/headless.svg)

## 参考连接

1. [New to JAMstack? Everything You Need to Know to Get Started](https://snipcart.com/blog/jamstack)
2. [What is a Headless CMS?](https://css-tricks.com/what-is-a-headless-cms/) By Chris Coyier
